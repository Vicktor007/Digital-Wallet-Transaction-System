2025-10-14T21:47:08.083+01:00  INFO 2344 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 2344 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T21:47:08.126+01:00  INFO 2344 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T21:47:13.385+01:00  INFO 2344 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T21:47:14.046+01:00  INFO 2344 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 585 ms. Found 2 JPA repository interfaces.
2025-10-14T21:47:18.284+01:00  INFO 2344 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T21:47:18.329+01:00  INFO 2344 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T21:47:18.331+01:00  INFO 2344 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T21:47:18.594+01:00  INFO 2344 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T21:47:18.598+01:00  INFO 2344 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 10242 ms
2025-10-14T21:47:20.051+01:00  INFO 20952 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Starting HistoryServiceApplication using Java 21.0.6 with PID 20952 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\History-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T21:47:20.057+01:00  INFO 20952 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : No active profile set, falling back to 1 default profile: "default"
2025-10-14T21:47:20.180+01:00  INFO 2344 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T21:47:21.144+01:00  INFO 2344 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@5b665a30
2025-10-14T21:47:21.147+01:00  INFO 2344 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T21:47:21.269+01:00  INFO 2344 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T21:47:22.566+01:00  INFO 20952 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T21:47:22.880+01:00  INFO 20952 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 300 ms. Found 1 JPA repository interface.
2025-10-14T21:47:23.441+01:00  INFO 2344 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:01.609s)
2025-10-14T21:47:23.542+01:00  INFO 2344 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T21:47:23.560+01:00  INFO 2344 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T21:47:23.783+01:00  INFO 2344 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T21:47:23.942+01:00  INFO 2344 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T21:47:24.038+01:00  INFO 2344 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T21:47:24.145+01:00  INFO 20952 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8081 (http)
2025-10-14T21:47:24.180+01:00  INFO 20952 --- [History-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T21:47:24.181+01:00  INFO 20952 --- [History-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T21:47:24.377+01:00  INFO 20952 --- [History-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T21:47:24.379+01:00  INFO 20952 --- [History-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 4067 ms
2025-10-14T21:47:24.813+01:00  INFO 20952 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T21:47:25.000+01:00  INFO 2344 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T21:47:25.319+01:00  INFO 2344 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T21:47:25.334+01:00  INFO 20952 --- [History-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@69a373fd
2025-10-14T21:47:25.339+01:00  INFO 20952 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T21:47:25.474+01:00  INFO 20952 --- [History-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T21:47:25.656+01:00  INFO 20952 --- [History-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T21:47:25.766+01:00  INFO 20952 --- [History-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T21:47:26.668+01:00  INFO 20952 --- [History-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T21:47:26.871+01:00  INFO 20952 --- [History-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T21:47:27.828+01:00  INFO 2344 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T21:47:27.828+01:00  INFO 2344 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T21:47:28.448+01:00  INFO 2344 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T21:47:28.794+01:00  INFO 20952 --- [History-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T21:47:28.802+01:00  INFO 20952 --- [History-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T21:47:30.470+01:00  INFO 20952 --- [History-Service] [main] o.s.v.b.OptionalValidatorFactoryBean     : Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-10-14T21:47:31.685+01:00  INFO 20952 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8081 (http) with context path '/'
2025-10-14T21:47:31.794+01:00  INFO 20952 --- [History-Service] [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-wallet_events-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = wallet_events
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.ErrorHandlingDeserializer

2025-10-14T21:47:31.874+01:00  INFO 2344 --- [Wallet-Service] [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	auto.include.jmx.reporter = true
	bootstrap.controllers = []
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-admin-0
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	enable.metrics.push = true
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2025-10-14T21:47:31.951+01:00  INFO 20952 --- [History-Service] [main] o.a.k.c.t.i.KafkaMetricsCollector        : initializing Kafka metrics collector
2025-10-14T21:47:31.977+01:00  INFO 20952 --- [History-Service] [main] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T21:47:31.982+01:00  INFO 20952 --- [History-Service] [main] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T21:47:31.982+01:00  INFO 20952 --- [History-Service] [main] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-10-14T21:47:31.983+01:00  INFO 20952 --- [History-Service] [main] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T21:47:31.983+01:00  INFO 20952 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-wallet_events-1 unregistered
2025-10-14T21:47:31.995+01:00  INFO 20952 --- [History-Service] [main] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T21:47:32.012+01:00  INFO 20952 --- [History-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T21:47:32.018+01:00  WARN 20952 --- [History-Service] [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'org.springframework.kafka.config.internalKafkaListenerEndpointRegistry'
2025-10-14T21:47:32.022+01:00  INFO 20952 --- [History-Service] [main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T21:47:32.027+01:00  INFO 20952 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T21:47:32.039+01:00  INFO 20952 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T21:47:32.076+01:00  INFO 20952 --- [History-Service] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-14T21:47:32.099+01:00  INFO 2344 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T21:47:32.099+01:00  INFO 2344 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T21:47:32.099+01:00  INFO 2344 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760474852095
2025-10-14T21:47:32.153+01:00 ERROR 20952 --- [History-Service] [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Failed to start bean 'org.springframework.kafka.config.internalKafkaListenerEndpointRegistry'
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:408) ~[spring-context-6.2.11.jar:6.2.11]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:394) ~[spring-context-6.2.11.jar:6.2.11]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:586) ~[spring-context-6.2.11.jar:6.2.11]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:364) ~[spring-context-6.2.11.jar:6.2.11]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:310) ~[spring-context-6.2.11.jar:6.2.11]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:1006) ~[spring-context-6.2.11.jar:6.2.11]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:630) ~[spring-context-6.2.11.jar:6.2.11]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.5.6.jar:3.5.6]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752) ~[spring-boot-3.5.6.jar:3.5.6]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439) ~[spring-boot-3.5.6.jar:3.5.6]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318) ~[spring-boot-3.5.6.jar:3.5.6]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361) ~[spring-boot-3.5.6.jar:3.5.6]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350) ~[spring-boot-3.5.6.jar:3.5.6]
	at com.vic.historyservice.HistoryServiceApplication.main(HistoryServiceApplication.java:10) ~[classes/:na]
Caused by: org.apache.kafka.common.KafkaException: Failed to construct kafka consumer
	at org.apache.kafka.clients.consumer.internals.ClassicKafkaConsumer.<init>(ClassicKafkaConsumer.java:270) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.ConsumerDelegateCreator.create(ConsumerDelegateCreator.java:65) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.KafkaConsumer.<init>(KafkaConsumer.java:600) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.KafkaConsumer.<init>(KafkaConsumer.java:595) ~[kafka-clients-3.9.1.jar:na]
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer.<init>(DefaultKafkaConsumerFactory.java:498) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory.createRawConsumer(DefaultKafkaConsumerFactory.java:453) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory.createKafkaConsumer(DefaultKafkaConsumerFactory.java:430) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory.createConsumerWithAdjustedProperties(DefaultKafkaConsumerFactory.java:407) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory.createKafkaConsumer(DefaultKafkaConsumerFactory.java:374) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaConsumerFactory.createConsumer(DefaultKafkaConsumerFactory.java:335) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.<init>(KafkaMessageListenerContainer.java:877) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer.doStart(KafkaMessageListenerContainer.java:388) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.AbstractMessageListenerContainer.start(AbstractMessageListenerContainer.java:520) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.ConcurrentMessageListenerContainer.doStart(ConcurrentMessageListenerContainer.java:264) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.AbstractMessageListenerContainer.start(AbstractMessageListenerContainer.java:520) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.config.KafkaListenerEndpointRegistry.startIfNecessary(KafkaListenerEndpointRegistry.java:436) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.config.KafkaListenerEndpointRegistry.start(KafkaListenerEndpointRegistry.java:382) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:405) ~[spring-context-6.2.11.jar:6.2.11]
	... 14 common frames omitted
Caused by: java.lang.IllegalArgumentException: Each comma-delimited mapping entry must have exactly one ':'
	at org.springframework.util.Assert.isTrue(Assert.java:116) ~[spring-core-6.2.11.jar:6.2.11]
	at org.springframework.kafka.support.serializer.JsonSerializer.createMappings(JsonSerializer.java:192) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.support.serializer.JsonDeserializer.createMappings(JsonDeserializer.java:447) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.support.serializer.JsonDeserializer.configure(JsonDeserializer.java:423) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.support.serializer.ErrorHandlingDeserializer.configure(ErrorHandlingDeserializer.java:137) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.apache.kafka.clients.consumer.internals.Deserializers.<init>(Deserializers.java:57) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.ClassicKafkaConsumer.<init>(ClassicKafkaConsumer.java:182) ~[kafka-clients-3.9.1.jar:na]
	... 31 common frames omitted

2025-10-14T21:47:35.896+01:00  INFO 2344 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for Wallet-Service-admin-0 unregistered
2025-10-14T21:47:35.908+01:00  INFO 2344 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T21:47:35.908+01:00  INFO 2344 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T21:47:35.909+01:00  INFO 2344 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T21:47:35.970+01:00  INFO 2344 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2025-10-14T21:47:36.017+01:00  INFO 2344 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Started WalletServiceApplication in 30.909 seconds (process running for 39.588)
2025-10-14T21:56:56.045+01:00  INFO 2344 --- [Wallet-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T21:56:56.189+01:00  INFO 2344 --- [Wallet-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T21:56:56.345+01:00  INFO 2344 --- [Wallet-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T21:56:56.456+01:00  INFO 2344 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T21:56:56.545+01:00  INFO 2344 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T21:57:05.457+01:00  INFO 2200 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 2200 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T21:57:05.466+01:00  INFO 2200 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T21:57:07.600+01:00  INFO 2200 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T21:57:07.760+01:00  INFO 2200 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 136 ms. Found 2 JPA repository interfaces.
2025-10-14T21:57:09.305+01:00  INFO 2200 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T21:57:09.347+01:00  INFO 2200 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T21:57:09.351+01:00  INFO 2200 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T21:57:09.553+01:00  INFO 2200 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T21:57:09.553+01:00  INFO 2200 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3938 ms
2025-10-14T21:57:11.148+01:00  INFO 2200 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T21:57:11.911+01:00  INFO 2200 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@f9b8129
2025-10-14T21:57:11.918+01:00  INFO 2200 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T21:57:12.049+01:00  INFO 2200 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T21:57:12.298+01:00  INFO 2200 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.102s)
2025-10-14T21:57:12.356+01:00  INFO 2200 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T21:57:12.373+01:00  INFO 2200 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T21:57:12.716+01:00  INFO 2200 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T21:57:12.964+01:00  INFO 2200 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T21:57:13.121+01:00  INFO 2200 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T21:57:13.652+01:00  INFO 1684 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Starting HistoryServiceApplication using Java 21.0.6 with PID 1684 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\History-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T21:57:13.663+01:00  INFO 1684 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : No active profile set, falling back to 1 default profile: "default"
2025-10-14T21:57:14.288+01:00  INFO 2200 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T21:57:15.799+01:00  INFO 2200 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T21:57:15.804+01:00  INFO 1684 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T21:57:15.921+01:00  INFO 1684 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 93 ms. Found 1 JPA repository interface.
2025-10-14T21:57:16.983+01:00  INFO 1684 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8081 (http)
2025-10-14T21:57:17.009+01:00  INFO 1684 --- [History-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T21:57:17.010+01:00  INFO 1684 --- [History-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T21:57:17.111+01:00  INFO 1684 --- [History-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T21:57:17.112+01:00  INFO 1684 --- [History-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3318 ms
2025-10-14T21:57:17.405+01:00  INFO 1684 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T21:57:17.714+01:00  INFO 1684 --- [History-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@203b953c
2025-10-14T21:57:17.717+01:00  INFO 1684 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T21:57:17.777+01:00  INFO 1684 --- [History-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T21:57:17.856+01:00  INFO 1684 --- [History-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T21:57:17.913+01:00  INFO 1684 --- [History-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T21:57:18.462+01:00  INFO 1684 --- [History-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T21:57:18.610+01:00  INFO 1684 --- [History-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T21:57:18.983+01:00  INFO 2200 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T21:57:18.991+01:00  INFO 2200 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T21:57:19.752+01:00  INFO 2200 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T21:57:20.628+01:00  INFO 1684 --- [History-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T21:57:20.636+01:00  INFO 1684 --- [History-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T21:57:21.812+01:00  INFO 1684 --- [History-Service] [main] o.s.v.b.OptionalValidatorFactoryBean     : Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-10-14T21:57:22.757+01:00  INFO 2200 --- [Wallet-Service] [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	auto.include.jmx.reporter = true
	bootstrap.controllers = []
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-admin-0
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	enable.metrics.push = true
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2025-10-14T21:57:23.020+01:00  INFO 2200 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T21:57:23.021+01:00  INFO 2200 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T21:57:23.022+01:00  INFO 2200 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760475443015
2025-10-14T21:57:23.233+01:00  INFO 1684 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8081 (http) with context path '/'
2025-10-14T21:57:23.343+01:00  INFO 1684 --- [History-Service] [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-wallet_events-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = wallet_events
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.ErrorHandlingDeserializer

2025-10-14T21:57:23.469+01:00  INFO 1684 --- [History-Service] [main] o.a.k.c.t.i.KafkaMetricsCollector        : initializing Kafka metrics collector
2025-10-14T21:57:23.669+01:00  INFO 1684 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T21:57:23.669+01:00  INFO 1684 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T21:57:23.670+01:00  INFO 1684 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760475443665
2025-10-14T21:57:23.677+01:00  INFO 1684 --- [History-Service] [main] o.a.k.c.c.i.ClassicKafkaConsumer         : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Subscribed to topic(s): wallet_event_topic
2025-10-14T21:57:23.717+01:00  INFO 1684 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Started HistoryServiceApplication in 11.837 seconds (process running for 14.741)
2025-10-14T21:57:24.339+01:00  INFO 2200 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for Wallet-Service-admin-0 unregistered
2025-10-14T21:57:24.349+01:00  INFO 2200 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T21:57:24.350+01:00  INFO 2200 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T21:57:24.350+01:00  INFO 2200 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T21:57:24.379+01:00  INFO 2200 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2025-10-14T21:57:24.398+01:00  INFO 2200 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Started WalletServiceApplication in 20.614 seconds (process running for 23.848)
2025-10-14T21:57:24.676+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Cluster ID: -BOr3paVQdKG6HAFHtQDWw
2025-10-14T21:57:24.807+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-10-14T21:57:24.812+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] (Re-)joining group
2025-10-14T21:57:25.112+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: need to re-join with the given member-id: consumer-wallet_events-1-36ee6cd4-1079-4c7f-9556-586597958394
2025-10-14T21:57:25.113+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] (Re-)joining group
2025-10-14T21:57:28.297+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Successfully joined group with generation Generation{generationId=5, memberId='consumer-wallet_events-1-36ee6cd4-1079-4c7f-9556-586597958394', protocol='range'}
2025-10-14T21:57:28.314+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Finished assignment for group at generation 5: {consumer-wallet_events-1-36ee6cd4-1079-4c7f-9556-586597958394=Assignment(partitions=[wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2])}
2025-10-14T21:57:28.609+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Successfully synced group in generation Generation{generationId=5, memberId='consumer-wallet_events-1-36ee6cd4-1079-4c7f-9556-586597958394', protocol='range'}
2025-10-14T21:57:28.609+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Notifying assignor about the new Assignment(partitions=[wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2])
2025-10-14T21:57:28.614+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] k.c.c.i.ConsumerRebalanceListenerInvoker : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Adding newly assigned partitions: wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2
2025-10-14T21:57:28.670+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Found no committed offset for partition wallet_event_topic-1
2025-10-14T21:57:28.670+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Found no committed offset for partition wallet_event_topic-2
2025-10-14T21:57:28.673+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils        : Setting offset for partition wallet_event_topic-0 to the committed offset FetchPosition{offset=1, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-10-14T21:57:28.733+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting offset for partition wallet_event_topic-1 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-10-14T21:57:28.733+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting offset for partition wallet_event_topic-2 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-10-14T21:57:28.734+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: partitions assigned: [wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2]
2025-10-14T21:58:03.691+01:00  INFO 2200 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-14T21:58:03.691+01:00  INFO 2200 --- [Wallet-Service] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-10-14T21:58:03.693+01:00  INFO 2200 --- [Wallet-Service] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2025-10-14T21:58:03.929+01:00  INFO 2200 --- [Wallet-Service] [http-nio-8080-exec-1] c.vic.walletservice.Kafka.KafkaProducer  : Sending event with body WalletEvent[eventType=WALLET_CREATED, walletId=8c659433-ddde-4026-b9e8-3c3ac49d1be3, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T21:58:03.771118800]
2025-10-14T21:58:03.963+01:00  INFO 2200 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-producer-1
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-10-14T21:58:04.006+01:00  INFO 2200 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.k.c.t.i.KafkaMetricsCollector        : initializing Kafka metrics collector
2025-10-14T21:58:04.022+01:00  INFO 2200 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=Wallet-Service-producer-1] Closing the Kafka producer with timeoutMillis = 0 ms.
2025-10-14T21:58:04.023+01:00  INFO 2200 --- [Wallet-Service] [http-nio-8080-exec-1] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T21:58:04.023+01:00  INFO 2200 --- [Wallet-Service] [http-nio-8080-exec-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T21:58:04.023+01:00  INFO 2200 --- [Wallet-Service] [http-nio-8080-exec-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-10-14T21:58:04.023+01:00  INFO 2200 --- [Wallet-Service] [http-nio-8080-exec-1] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T21:58:04.024+01:00  INFO 2200 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.producer for Wallet-Service-producer-1 unregistered
2025-10-14T21:58:04.025+01:00 ERROR 2200 --- [Wallet-Service] [http-nio-8080-exec-1] c.v.w.Services.walletService             : Error while sending event asynchronously WalletEvent[eventType=WALLET_CREATED, walletId=8c659433-ddde-4026-b9e8-3c3ac49d1be3, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T21:58:03.771118800]

org.apache.kafka.common.KafkaException: Failed to construct kafka producer
	at org.apache.kafka.clients.producer.KafkaProducer.<init>(KafkaProducer.java:476) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.producer.KafkaProducer.<init>(KafkaProducer.java:297) ~[kafka-clients-3.9.1.jar:na]
	at org.springframework.kafka.core.DefaultKafkaProducerFactory.createRawProducer(DefaultKafkaProducerFactory.java:944) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaProducerFactory.createKafkaProducer(DefaultKafkaProducerFactory.java:826) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaProducerFactory.doCreateProducer(DefaultKafkaProducerFactory.java:793) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaProducerFactory.createProducer(DefaultKafkaProducerFactory.java:768) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaProducerFactory.createProducer(DefaultKafkaProducerFactory.java:762) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.KafkaTemplate.getTheProducer(KafkaTemplate.java:991) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.KafkaTemplate.doSend(KafkaTemplate.java:843) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.KafkaTemplate.observeSend(KafkaTemplate.java:820) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.KafkaTemplate.send(KafkaTemplate.java:597) ~[spring-kafka-3.3.10.jar:3.3.10]
	at com.vic.walletservice.Kafka.KafkaProducer.sendEvent(KafkaProducer.java:24) ~[classes/:na]
	at com.vic.walletservice.Services.walletService.sendKafkaEvent(walletService.java:211) ~[classes/:na]
	at com.vic.walletservice.Services.walletService.createWallet(walletService.java:53) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724) ~[spring-aop-6.2.11.jar:6.2.11]
	at com.vic.walletservice.Services.walletService$$SpringCGLIB$$0.createWallet(<generated>) ~[classes/:na]
	at com.vic.walletservice.Controller.WalletController.createWallet(WalletController.java:67) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.46.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.46.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1776) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:975) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:493) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: java.lang.IllegalArgumentException: Failed to load: com.vic.historyservice.Dtos.WalletEvent for WalletEvent
	at org.springframework.kafka.support.serializer.JsonSerializer.createMappings(JsonSerializer.java:198) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.support.serializer.JsonSerializer.configure(JsonSerializer.java:178) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.apache.kafka.clients.producer.KafkaProducer.<init>(KafkaProducer.java:400) ~[kafka-clients-3.9.1.jar:na]
	... 67 common frames omitted
Caused by: java.lang.ClassNotFoundException: com.vic.historyservice.Dtos.WalletEvent
	at org.springframework.boot.web.embedded.tomcat.TomcatEmbeddedWebappClassLoader.loadClass(TomcatEmbeddedWebappClassLoader.java:72) ~[spring-boot-3.5.6.jar:3.5.6]
	at org.apache.catalina.loader.WebappClassLoaderBase.loadClass(WebappClassLoaderBase.java:1189) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at java.base/java.lang.Class.forName0(Native Method) ~[na:na]
	at java.base/java.lang.Class.forName(Class.java:534) ~[na:na]
	at java.base/java.lang.Class.forName(Class.java:513) ~[na:na]
	at org.springframework.util.ClassUtils.forName(ClassUtils.java:321) ~[spring-core-6.2.11.jar:6.2.11]
	at org.springframework.kafka.support.serializer.JsonSerializer.createMappings(JsonSerializer.java:195) ~[spring-kafka-3.3.10.jar:3.3.10]
	... 69 common frames omitted

2025-10-14T21:58:21.200+01:00  INFO 2200 --- [Wallet-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T21:58:21.213+01:00  INFO 2200 --- [Wallet-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T21:58:21.233+01:00  INFO 2200 --- [Wallet-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T21:58:21.239+01:00  INFO 2200 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T21:58:21.248+01:00  INFO 2200 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T21:58:26.876+01:00  INFO 1180 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 1180 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T21:58:26.882+01:00  INFO 1180 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T21:58:28.390+01:00  INFO 1180 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T21:58:28.492+01:00  INFO 1180 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 88 ms. Found 2 JPA repository interfaces.
2025-10-14T21:58:29.490+01:00  INFO 1180 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T21:58:29.512+01:00  INFO 1180 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T21:58:29.513+01:00  INFO 1180 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T21:58:29.624+01:00  INFO 1180 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T21:58:29.624+01:00  INFO 1180 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2637 ms
2025-10-14T21:58:30.253+01:00  INFO 1180 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T21:58:30.549+01:00  INFO 1180 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@cd5ff55
2025-10-14T21:58:30.552+01:00  INFO 1180 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T21:58:30.606+01:00  INFO 1180 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T21:58:30.730+01:00  INFO 1180 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.062s)
2025-10-14T21:58:30.769+01:00  INFO 1180 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T21:58:30.778+01:00  INFO 1180 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T21:58:30.976+01:00  INFO 1180 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T21:58:31.138+01:00  INFO 1180 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T21:58:31.220+01:00  INFO 1180 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T21:58:31.792+01:00  INFO 1180 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T21:58:31.989+01:00  INFO 1180 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T21:58:34.013+01:00  INFO 1180 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T21:58:34.018+01:00  INFO 1180 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T21:58:34.533+01:00  INFO 1180 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T21:58:36.620+01:00  INFO 1180 --- [Wallet-Service] [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	auto.include.jmx.reporter = true
	bootstrap.controllers = []
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-admin-0
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	enable.metrics.push = true
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2025-10-14T21:58:36.769+01:00  INFO 1180 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T21:58:36.769+01:00  INFO 1180 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T21:58:36.770+01:00  INFO 1180 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760475516766
2025-10-14T21:58:37.724+01:00  INFO 1180 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for Wallet-Service-admin-0 unregistered
2025-10-14T21:58:37.736+01:00  INFO 1180 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T21:58:37.736+01:00  INFO 1180 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T21:58:37.737+01:00  INFO 1180 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T21:58:37.762+01:00  INFO 1180 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2025-10-14T21:58:37.775+01:00  INFO 1180 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Started WalletServiceApplication in 12.064 seconds (process running for 14.142)
2025-10-14T21:59:24.652+01:00  INFO 1180 --- [Wallet-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T21:59:24.660+01:00  INFO 1180 --- [Wallet-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T21:59:24.665+01:00  INFO 1180 --- [Wallet-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T21:59:24.667+01:00  INFO 1180 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T21:59:24.673+01:00  INFO 1180 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T21:59:30.039+01:00  INFO 12708 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 12708 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T21:59:30.052+01:00  INFO 12708 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T21:59:32.164+01:00  INFO 12708 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T21:59:32.286+01:00  INFO 12708 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 103 ms. Found 2 JPA repository interfaces.
2025-10-14T21:59:33.352+01:00  INFO 12708 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T21:59:33.375+01:00  INFO 12708 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T21:59:33.376+01:00  INFO 12708 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T21:59:33.488+01:00  INFO 12708 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T21:59:33.489+01:00  INFO 12708 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3242 ms
2025-10-14T21:59:33.999+01:00  INFO 12708 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T21:59:34.249+01:00  INFO 12708 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@53ba1175
2025-10-14T21:59:34.252+01:00  INFO 12708 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T21:59:34.301+01:00  INFO 12708 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T21:59:34.405+01:00  INFO 12708 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.055s)
2025-10-14T21:59:34.440+01:00  INFO 12708 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T21:59:34.446+01:00  INFO 12708 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T21:59:34.623+01:00  INFO 12708 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T21:59:34.744+01:00  INFO 12708 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T21:59:34.812+01:00  INFO 12708 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T21:59:35.324+01:00  INFO 12708 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T21:59:35.474+01:00  INFO 12708 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T21:59:37.006+01:00  INFO 12708 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T21:59:37.013+01:00  INFO 12708 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T21:59:37.549+01:00  INFO 12708 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T21:59:39.799+01:00  INFO 12708 --- [Wallet-Service] [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	auto.include.jmx.reporter = true
	bootstrap.controllers = []
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-admin-0
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	enable.metrics.push = true
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2025-10-14T21:59:40.191+01:00  INFO 12708 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T21:59:40.192+01:00  INFO 12708 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T21:59:40.193+01:00  INFO 12708 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760475580189
2025-10-14T21:59:40.841+01:00  INFO 12708 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for Wallet-Service-admin-0 unregistered
2025-10-14T21:59:40.847+01:00  INFO 12708 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T21:59:40.847+01:00  INFO 12708 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T21:59:40.848+01:00  INFO 12708 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T21:59:40.866+01:00  INFO 12708 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2025-10-14T21:59:40.878+01:00  INFO 12708 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Started WalletServiceApplication in 12.321 seconds (process running for 14.258)
2025-10-14T21:59:40.881+01:00  INFO 12708 --- [Wallet-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T21:59:40.889+01:00  INFO 12708 --- [Wallet-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T21:59:40.894+01:00  INFO 12708 --- [Wallet-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T21:59:40.896+01:00  INFO 12708 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T21:59:40.902+01:00  INFO 12708 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T21:59:46.006+01:00  INFO 6024 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 6024 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T21:59:46.025+01:00  INFO 6024 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T21:59:48.045+01:00  INFO 6024 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T21:59:48.171+01:00  INFO 6024 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 104 ms. Found 2 JPA repository interfaces.
2025-10-14T21:59:49.287+01:00  INFO 6024 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T21:59:49.311+01:00  INFO 6024 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T21:59:49.311+01:00  INFO 6024 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T21:59:49.465+01:00  INFO 6024 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T21:59:49.468+01:00  INFO 6024 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3309 ms
2025-10-14T21:59:50.346+01:00  INFO 6024 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T21:59:50.639+01:00  INFO 6024 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@320ff86f
2025-10-14T21:59:50.643+01:00  INFO 6024 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T21:59:50.705+01:00  INFO 6024 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T21:59:50.828+01:00  INFO 6024 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.067s)
2025-10-14T21:59:50.871+01:00  INFO 6024 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T21:59:50.880+01:00  INFO 6024 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T21:59:51.071+01:00  INFO 6024 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T21:59:51.332+01:00  INFO 6024 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T21:59:51.438+01:00  INFO 6024 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T21:59:52.205+01:00  INFO 6024 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T21:59:52.375+01:00  INFO 6024 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T21:59:54.241+01:00  INFO 6024 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T21:59:54.247+01:00  INFO 6024 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T21:59:55.179+01:00  INFO 6024 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T21:59:57.940+01:00  INFO 6024 --- [Wallet-Service] [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	auto.include.jmx.reporter = true
	bootstrap.controllers = []
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-admin-0
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	enable.metrics.push = true
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2025-10-14T21:59:58.076+01:00  INFO 6024 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T21:59:58.077+01:00  INFO 6024 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T21:59:58.077+01:00  INFO 6024 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760475598073
2025-10-14T21:59:59.029+01:00  INFO 6024 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for Wallet-Service-admin-0 unregistered
2025-10-14T21:59:59.039+01:00  INFO 6024 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T21:59:59.040+01:00  INFO 6024 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T21:59:59.040+01:00  INFO 6024 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T21:59:59.068+01:00  INFO 6024 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2025-10-14T21:59:59.085+01:00  INFO 6024 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Started WalletServiceApplication in 14.603 seconds (process running for 16.538)
2025-10-14T22:03:30.921+01:00  INFO 6024 --- [Wallet-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T22:03:30.985+01:00  INFO 6024 --- [Wallet-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T22:03:31.073+01:00  INFO 6024 --- [Wallet-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:03:31.151+01:00  INFO 6024 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:03:31.195+01:00  INFO 6024 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:03:38.036+01:00  INFO 8204 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 8204 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:03:38.042+01:00  INFO 8204 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:03:39.793+01:00  INFO 8204 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:03:39.903+01:00  INFO 8204 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 92 ms. Found 2 JPA repository interfaces.
2025-10-14T22:03:41.167+01:00  INFO 8204 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T22:03:41.202+01:00  INFO 8204 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:03:41.203+01:00  INFO 8204 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:03:41.343+01:00  INFO 8204 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:03:41.344+01:00  INFO 8204 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3184 ms
2025-10-14T22:03:41.867+01:00  INFO 8204 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:03:42.234+01:00  INFO 8204 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@7e3ee128
2025-10-14T22:03:42.237+01:00  INFO 8204 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:03:42.299+01:00  INFO 8204 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T22:03:42.434+01:00  INFO 8204 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.068s)
2025-10-14T22:03:42.483+01:00  INFO 8204 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T22:03:42.491+01:00  INFO 8204 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T22:03:42.677+01:00  INFO 8204 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:03:42.876+01:00  INFO 8204 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:03:42.984+01:00  INFO 8204 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:03:43.710+01:00  INFO 8204 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:03:43.899+01:00  INFO 8204 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:03:45.756+01:00  INFO 8204 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:03:45.764+01:00  INFO 8204 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:03:46.298+01:00  INFO 8204 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T22:03:47.126+01:00  WARN 8204 --- [Wallet-Service] [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'walletController' defined in file [C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes\com\vic\walletservice\Controller\WalletController.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'walletService' defined in file [C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes\com\vic\walletservice\Services\walletService.class]: Unsatisfied dependency expressed through constructor parameter 2: Error creating bean with name 'kafkaProducer' defined in file [C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes\com\vic\walletservice\Kafka\KafkaProducer.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration': Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'spring.kafka-org.springframework.boot.autoconfigure.kafka.KafkaProperties': Could not bind properties to 'KafkaProperties' : prefix=spring.kafka, ignoreInvalidFields=false, ignoreUnknownFields=true
2025-10-14T22:03:47.127+01:00  INFO 8204 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:03:47.130+01:00  INFO 8204 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:03:47.137+01:00  INFO 8204 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:03:47.141+01:00  INFO 8204 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2025-10-14T22:03:47.169+01:00  INFO 8204 --- [Wallet-Service] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-14T22:03:47.201+01:00 ERROR 8204 --- [Wallet-Service] [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Failed to bind properties under 'spring.kafka.producer.value-serializer' to java.lang.Class<?>:

    Property: spring.kafka.producer.value-serializer
    Value: "org.springframework.kafka.support.serializer.ErrorHandlingSerializer"
    Origin: class path resource [application.properties] - 14:40
    Reason: failed to convert java.lang.String to java.lang.Class<?> (caused by java.lang.ClassNotFoundException: org.springframework.kafka.support.serializer.ErrorHandlingSerializer)

Action:

Update your application's configuration

2025-10-14T22:08:12.390+01:00  INFO 6796 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 6796 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:08:12.396+01:00  INFO 6796 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:08:14.437+01:00  INFO 6796 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:08:14.565+01:00  INFO 6796 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 110 ms. Found 2 JPA repository interfaces.
2025-10-14T22:08:16.921+01:00  INFO 6796 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T22:08:16.937+01:00  INFO 6796 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:08:16.938+01:00  INFO 6796 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:08:17.021+01:00  INFO 6796 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:08:17.022+01:00  INFO 6796 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 4503 ms
2025-10-14T22:08:17.378+01:00  INFO 6796 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:08:17.626+01:00  INFO 6796 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@7d64a960
2025-10-14T22:08:17.628+01:00  INFO 6796 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:08:17.675+01:00  INFO 6796 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T22:08:17.782+01:00  INFO 6796 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.054s)
2025-10-14T22:08:17.815+01:00  INFO 6796 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T22:08:17.822+01:00  INFO 6796 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T22:08:17.997+01:00  INFO 6796 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:08:18.121+01:00  INFO 6796 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:08:18.196+01:00  INFO 6796 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:08:18.747+01:00  INFO 6796 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:08:18.906+01:00  INFO 6796 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:08:20.699+01:00  INFO 6796 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:08:20.708+01:00  INFO 6796 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:08:21.272+01:00  INFO 6796 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T22:08:22.160+01:00  WARN 6796 --- [Wallet-Service] [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'walletController' defined in file [C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes\com\vic\walletservice\Controller\WalletController.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'walletService' defined in file [C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes\com\vic\walletservice\Services\walletService.class]: Unsatisfied dependency expressed through constructor parameter 2: Error creating bean with name 'kafkaProducer' defined in file [C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes\com\vic\walletservice\Kafka\KafkaProducer.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration': Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'spring.kafka-org.springframework.boot.autoconfigure.kafka.KafkaProperties': Could not bind properties to 'KafkaProperties' : prefix=spring.kafka, ignoreInvalidFields=false, ignoreUnknownFields=true
2025-10-14T22:08:22.161+01:00  INFO 6796 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:08:22.165+01:00  INFO 6796 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:08:22.173+01:00  INFO 6796 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:08:22.180+01:00  INFO 6796 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2025-10-14T22:08:22.203+01:00  INFO 6796 --- [Wallet-Service] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-14T22:08:22.234+01:00 ERROR 6796 --- [Wallet-Service] [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Failed to bind properties under 'spring.kafka.producer.value-serializer' to java.lang.Class<?>:

    Property: spring.kafka.producer.value-serializer
    Value: "org.springframework.kafka.support.serializer.ErrorHandlingSerializer"
    Origin: class path resource [application.properties] - 19:40
    Reason: failed to convert java.lang.String to java.lang.Class<?> (caused by java.lang.ClassNotFoundException: org.springframework.kafka.support.serializer.ErrorHandlingSerializer)

Action:

Update your application's configuration

2025-10-14T22:18:02.727+01:00  INFO 14436 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 14436 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:18:02.734+01:00  INFO 14436 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:18:05.130+01:00  INFO 14436 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:18:05.257+01:00  INFO 14436 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 110 ms. Found 2 JPA repository interfaces.
2025-10-14T22:18:06.480+01:00  INFO 14436 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T22:18:06.505+01:00  INFO 14436 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:18:06.507+01:00  INFO 14436 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:18:06.642+01:00  INFO 14436 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:18:06.643+01:00  INFO 14436 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3715 ms
2025-10-14T22:18:07.241+01:00  INFO 14436 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:18:07.591+01:00  INFO 14436 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@320ff86f
2025-10-14T22:18:07.594+01:00  INFO 14436 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:18:07.676+01:00  INFO 14436 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T22:18:07.842+01:00  INFO 14436 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.080s)
2025-10-14T22:18:07.883+01:00  INFO 14436 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T22:18:07.898+01:00  INFO 14436 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T22:18:08.108+01:00  INFO 14436 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:18:08.252+01:00  INFO 14436 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:18:08.355+01:00  INFO 14436 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:18:09.840+01:00  INFO 14436 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:18:09.995+01:00  INFO 14436 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:18:12.279+01:00  INFO 14436 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:18:12.285+01:00  INFO 14436 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:18:12.735+01:00  INFO 14436 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T22:18:13.672+01:00  WARN 14436 --- [Wallet-Service] [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'walletController' defined in file [C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes\com\vic\walletservice\Controller\WalletController.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'walletService' defined in file [C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes\com\vic\walletservice\Services\walletService.class]: Unsatisfied dependency expressed through constructor parameter 2: Error creating bean with name 'kafkaProducer' defined in file [C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes\com\vic\walletservice\Kafka\KafkaProducer.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration': Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'spring.kafka-org.springframework.boot.autoconfigure.kafka.KafkaProperties': Could not bind properties to 'KafkaProperties' : prefix=spring.kafka, ignoreInvalidFields=false, ignoreUnknownFields=true
2025-10-14T22:18:13.673+01:00  INFO 14436 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:18:13.677+01:00  INFO 14436 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:18:13.685+01:00  INFO 14436 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:18:13.692+01:00  INFO 14436 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2025-10-14T22:18:13.718+01:00  INFO 14436 --- [Wallet-Service] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-14T22:18:13.757+01:00 ERROR 14436 --- [Wallet-Service] [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Failed to bind properties under 'spring.kafka.producer.value-serializer' to java.lang.Class<?>:

    Property: spring.kafka.producer.value-serializer
    Value: "org.springframework.kafka.support.serializer.ErrorHandlingSerializer"
    Origin: class path resource [application.properties] - 19:40
    Reason: failed to convert java.lang.String to java.lang.Class<?> (caused by java.lang.ClassNotFoundException: org.springframework.kafka.support.serializer.ErrorHandlingSerializer)

Action:

Update your application's configuration

2025-10-14T22:20:35.685+01:00  INFO 15124 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 15124 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:20:35.692+01:00  INFO 15124 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:20:37.750+01:00  INFO 15124 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:20:37.920+01:00  INFO 15124 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 145 ms. Found 2 JPA repository interfaces.
2025-10-14T22:20:39.479+01:00  INFO 15124 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T22:20:39.522+01:00  INFO 15124 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:20:39.523+01:00  INFO 15124 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:20:39.725+01:00  INFO 15124 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:20:39.728+01:00  INFO 15124 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3912 ms
2025-10-14T22:20:40.687+01:00  INFO 15124 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:20:41.341+01:00  INFO 15124 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@84f51d9
2025-10-14T22:20:41.351+01:00  INFO 15124 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:20:41.477+01:00  INFO 15124 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T22:20:41.735+01:00  INFO 15124 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.129s)
2025-10-14T22:20:41.804+01:00  INFO 15124 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T22:20:41.814+01:00  INFO 15124 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T22:20:42.142+01:00  INFO 15124 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:20:42.372+01:00  INFO 15124 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:20:42.496+01:00  INFO 15124 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:20:42.702+01:00  INFO 6128 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 6128 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:20:42.708+01:00  INFO 6128 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:20:43.582+01:00  INFO 15124 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:20:43.922+01:00  INFO 15124 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:20:45.251+01:00  INFO 6128 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:20:45.371+01:00  INFO 6128 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 99 ms. Found 2 JPA repository interfaces.
2025-10-14T22:20:47.232+01:00  INFO 6128 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T22:20:47.287+01:00  INFO 6128 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:20:47.288+01:00  INFO 6128 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:20:47.422+01:00  INFO 6128 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:20:47.423+01:00  INFO 6128 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 4574 ms
2025-10-14T22:20:48.045+01:00  INFO 15124 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:20:48.053+01:00  INFO 15124 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:20:48.098+01:00  INFO 6128 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:20:48.463+01:00  INFO 6128 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@166ce247
2025-10-14T22:20:48.468+01:00  INFO 6128 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:20:48.534+01:00  INFO 6128 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T22:20:48.665+01:00  INFO 6128 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.077s)
2025-10-14T22:20:48.718+01:00  INFO 6128 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T22:20:48.726+01:00  INFO 6128 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T22:20:48.861+01:00  INFO 15124 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T22:20:48.955+01:00  INFO 6128 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:20:49.063+01:00  INFO 6128 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:20:49.141+01:00  INFO 6128 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:20:49.842+01:00  INFO 6128 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:20:50.038+01:00  INFO 6128 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:20:52.051+01:00  INFO 15124 --- [Wallet-Service] [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	auto.include.jmx.reporter = true
	bootstrap.controllers = []
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-admin-0
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	enable.metrics.push = true
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2025-10-14T22:20:52.282+01:00  INFO 15124 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T22:20:52.283+01:00  INFO 15124 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T22:20:52.283+01:00  INFO 15124 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760476852278
2025-10-14T22:20:52.496+01:00  INFO 6128 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:20:52.505+01:00  INFO 6128 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:20:53.286+01:00  INFO 6128 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T22:20:53.628+01:00  INFO 15124 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for Wallet-Service-admin-0 unregistered
2025-10-14T22:20:53.640+01:00  INFO 15124 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T22:20:53.640+01:00  INFO 15124 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T22:20:53.641+01:00  INFO 15124 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T22:20:53.678+01:00  INFO 15124 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2025-10-14T22:20:53.705+01:00  INFO 15124 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Started WalletServiceApplication in 19.375 seconds (process running for 21.803)
2025-10-14T22:20:55.274+01:00  INFO 6128 --- [Wallet-Service] [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	auto.include.jmx.reporter = true
	bootstrap.controllers = []
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-admin-0
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	enable.metrics.push = true
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2025-10-14T22:20:55.357+01:00  INFO 6128 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T22:20:55.357+01:00  INFO 6128 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T22:20:55.358+01:00  INFO 6128 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760476855355
2025-10-14T22:20:56.211+01:00  INFO 6128 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for Wallet-Service-admin-0 unregistered
2025-10-14T22:20:56.218+01:00  INFO 6128 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T22:20:56.219+01:00  INFO 6128 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T22:20:56.219+01:00  INFO 6128 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T22:20:56.267+01:00  WARN 6128 --- [Wallet-Service] [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-10-14T22:20:56.269+01:00  INFO 6128 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:20:56.271+01:00  INFO 6128 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:20:56.275+01:00  INFO 6128 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:20:56.550+01:00  INFO 6128 --- [Wallet-Service] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-10-14T22:20:56.569+01:00 ERROR 6128 --- [Wallet-Service] [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2025-10-14T22:21:20.963+01:00  INFO 15124 --- [Wallet-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T22:21:20.983+01:00  INFO 15124 --- [Wallet-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T22:21:20.992+01:00  INFO 15124 --- [Wallet-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:21:20.995+01:00  INFO 15124 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:21:21.001+01:00  INFO 15124 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:21:34.439+01:00  INFO 6620 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 6620 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:21:34.445+01:00  INFO 6620 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:21:36.099+01:00  INFO 6620 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:21:36.205+01:00  INFO 6620 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 88 ms. Found 2 JPA repository interfaces.
2025-10-14T22:21:37.229+01:00  INFO 6620 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T22:21:37.253+01:00  INFO 6620 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:21:37.253+01:00  INFO 6620 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:21:37.343+01:00  INFO 6620 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:21:37.344+01:00  INFO 6620 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2787 ms
2025-10-14T22:21:37.842+01:00  INFO 6620 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:21:38.116+01:00  INFO 6620 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@32b46831
2025-10-14T22:21:38.120+01:00  INFO 6620 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:21:38.170+01:00  INFO 6620 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T22:21:38.266+01:00  INFO 6620 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.056s)
2025-10-14T22:21:38.305+01:00  INFO 6620 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T22:21:38.313+01:00  INFO 6620 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T22:21:38.479+01:00  INFO 6620 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:21:38.602+01:00  INFO 6620 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:21:38.673+01:00  INFO 6620 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:21:39.233+01:00  INFO 6620 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:21:39.389+01:00  INFO 6620 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:21:41.218+01:00  INFO 6620 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:21:41.224+01:00  INFO 6620 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:21:41.787+01:00  INFO 6620 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T22:21:43.668+01:00  INFO 6620 --- [Wallet-Service] [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	auto.include.jmx.reporter = true
	bootstrap.controllers = []
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-admin-0
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	enable.metrics.push = true
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2025-10-14T22:21:43.800+01:00  INFO 6620 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T22:21:43.800+01:00  INFO 6620 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T22:21:43.801+01:00  INFO 6620 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760476903797
2025-10-14T22:21:44.642+01:00  INFO 6620 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for Wallet-Service-admin-0 unregistered
2025-10-14T22:21:44.652+01:00  INFO 6620 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T22:21:44.652+01:00  INFO 6620 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T22:21:44.653+01:00  INFO 6620 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T22:21:44.679+01:00  INFO 6620 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2025-10-14T22:21:44.695+01:00  INFO 6620 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Started WalletServiceApplication in 11.471 seconds (process running for 13.421)
2025-10-14T22:22:07.696+01:00  INFO 6620 --- [Wallet-Service] [http-nio-8080-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-14T22:22:07.697+01:00  INFO 6620 --- [Wallet-Service] [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-10-14T22:22:07.698+01:00  INFO 6620 --- [Wallet-Service] [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2025-10-14T22:22:07.950+01:00  INFO 6620 --- [Wallet-Service] [http-nio-8080-exec-2] c.vic.walletservice.Kafka.KafkaProducer  : Sending event with body WalletEvent[eventType=WALLET_CREATED, walletId=642f656a-4ced-4b0b-a7fc-cb5e960cbaf4, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:22:07.779616600]
2025-10-14T22:22:07.992+01:00  INFO 6620 --- [Wallet-Service] [http-nio-8080-exec-2] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-producer-1
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-10-14T22:22:08.052+01:00  INFO 6620 --- [Wallet-Service] [http-nio-8080-exec-2] o.a.k.c.t.i.KafkaMetricsCollector        : initializing Kafka metrics collector
2025-10-14T22:22:08.069+01:00  INFO 6620 --- [Wallet-Service] [http-nio-8080-exec-2] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=Wallet-Service-producer-1] Closing the Kafka producer with timeoutMillis = 0 ms.
2025-10-14T22:22:08.071+01:00  INFO 6620 --- [Wallet-Service] [http-nio-8080-exec-2] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T22:22:08.071+01:00  INFO 6620 --- [Wallet-Service] [http-nio-8080-exec-2] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T22:22:08.071+01:00  INFO 6620 --- [Wallet-Service] [http-nio-8080-exec-2] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-10-14T22:22:08.071+01:00  INFO 6620 --- [Wallet-Service] [http-nio-8080-exec-2] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T22:22:08.072+01:00  INFO 6620 --- [Wallet-Service] [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : App info kafka.producer for Wallet-Service-producer-1 unregistered
2025-10-14T22:22:08.074+01:00 ERROR 6620 --- [Wallet-Service] [http-nio-8080-exec-2] c.v.w.Services.walletService             : Error while sending event asynchronously WalletEvent[eventType=WALLET_CREATED, walletId=642f656a-4ced-4b0b-a7fc-cb5e960cbaf4, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:22:07.779616600]

org.apache.kafka.common.KafkaException: Failed to construct kafka producer
	at org.apache.kafka.clients.producer.KafkaProducer.<init>(KafkaProducer.java:476) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.producer.KafkaProducer.<init>(KafkaProducer.java:297) ~[kafka-clients-3.9.1.jar:na]
	at org.springframework.kafka.core.DefaultKafkaProducerFactory.createRawProducer(DefaultKafkaProducerFactory.java:944) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaProducerFactory.createKafkaProducer(DefaultKafkaProducerFactory.java:826) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaProducerFactory.doCreateProducer(DefaultKafkaProducerFactory.java:793) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaProducerFactory.createProducer(DefaultKafkaProducerFactory.java:768) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.DefaultKafkaProducerFactory.createProducer(DefaultKafkaProducerFactory.java:762) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.KafkaTemplate.getTheProducer(KafkaTemplate.java:991) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.KafkaTemplate.doSend(KafkaTemplate.java:843) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.KafkaTemplate.observeSend(KafkaTemplate.java:820) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.core.KafkaTemplate.send(KafkaTemplate.java:597) ~[spring-kafka-3.3.10.jar:3.3.10]
	at com.vic.walletservice.Kafka.KafkaProducer.sendEvent(KafkaProducer.java:24) ~[classes/:na]
	at com.vic.walletservice.Services.walletService.sendKafkaEvent(walletService.java:211) ~[classes/:na]
	at com.vic.walletservice.Services.walletService.createWallet(walletService.java:53) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724) ~[spring-aop-6.2.11.jar:6.2.11]
	at com.vic.walletservice.Services.walletService$$SpringCGLIB$$0.createWallet(<generated>) ~[classes/:na]
	at com.vic.walletservice.Controller.WalletController.createWallet(WalletController.java:67) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.46.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.46.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1776) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:975) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:493) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: java.lang.IllegalArgumentException: Failed to load: com.vic.historyservice.Dtos.WalletEvent for WalletEvent
	at org.springframework.kafka.support.serializer.JsonSerializer.createMappings(JsonSerializer.java:198) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.support.serializer.JsonSerializer.configure(JsonSerializer.java:178) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.apache.kafka.clients.producer.KafkaProducer.<init>(KafkaProducer.java:400) ~[kafka-clients-3.9.1.jar:na]
	... 67 common frames omitted
Caused by: java.lang.ClassNotFoundException: com.vic.historyservice.Dtos.WalletEvent
	at org.springframework.boot.web.embedded.tomcat.TomcatEmbeddedWebappClassLoader.loadClass(TomcatEmbeddedWebappClassLoader.java:72) ~[spring-boot-3.5.6.jar:3.5.6]
	at org.apache.catalina.loader.WebappClassLoaderBase.loadClass(WebappClassLoaderBase.java:1189) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at java.base/java.lang.Class.forName0(Native Method) ~[na:na]
	at java.base/java.lang.Class.forName(Class.java:534) ~[na:na]
	at java.base/java.lang.Class.forName(Class.java:513) ~[na:na]
	at org.springframework.util.ClassUtils.forName(ClassUtils.java:321) ~[spring-core-6.2.11.jar:6.2.11]
	at org.springframework.kafka.support.serializer.JsonSerializer.createMappings(JsonSerializer.java:195) ~[spring-kafka-3.3.10.jar:3.3.10]
	... 69 common frames omitted

2025-10-14T22:23:40.491+01:00  INFO 6620 --- [Wallet-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T22:23:40.500+01:00  INFO 6620 --- [Wallet-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T22:23:40.505+01:00  INFO 6620 --- [Wallet-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:23:40.506+01:00  INFO 6620 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:23:40.514+01:00  INFO 6620 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:23:44.507+01:00  INFO 9932 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 9932 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:23:44.511+01:00  INFO 9932 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:23:45.708+01:00  INFO 9932 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:23:45.792+01:00  INFO 9932 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 72 ms. Found 2 JPA repository interfaces.
2025-10-14T22:23:46.546+01:00  INFO 9932 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T22:23:46.564+01:00  INFO 9932 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:23:46.564+01:00  INFO 9932 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:23:46.654+01:00  INFO 9932 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:23:46.655+01:00  INFO 9932 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2055 ms
2025-10-14T22:23:47.005+01:00  INFO 9932 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:23:47.196+01:00  INFO 9932 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@5353dd09
2025-10-14T22:23:47.198+01:00  INFO 9932 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:23:47.236+01:00  INFO 9932 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T22:23:47.308+01:00  INFO 9932 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.036s)
2025-10-14T22:23:47.345+01:00  INFO 9932 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T22:23:47.349+01:00  INFO 9932 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T22:23:47.448+01:00  INFO 9932 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:23:47.528+01:00  INFO 9932 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:23:47.566+01:00  INFO 9932 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:23:47.920+01:00  INFO 9932 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:23:48.015+01:00  INFO 9932 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:23:49.009+01:00  INFO 9932 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:23:49.013+01:00  INFO 9932 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:23:49.366+01:00  INFO 9932 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T22:23:50.801+01:00  INFO 9932 --- [Wallet-Service] [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	auto.include.jmx.reporter = true
	bootstrap.controllers = []
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-admin-0
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	enable.metrics.push = true
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2025-10-14T22:23:50.879+01:00  INFO 9932 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T22:23:50.880+01:00  INFO 9932 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T22:23:50.880+01:00  INFO 9932 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760477030877
2025-10-14T22:23:51.553+01:00  INFO 9932 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for Wallet-Service-admin-0 unregistered
2025-10-14T22:23:51.558+01:00  INFO 9932 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T22:23:51.559+01:00  INFO 9932 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T22:23:51.559+01:00  INFO 9932 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T22:23:51.585+01:00  INFO 9932 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2025-10-14T22:23:51.597+01:00  INFO 9932 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Started WalletServiceApplication in 7.993 seconds (process running for 9.109)
2025-10-14T22:24:10.283+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] k.c.c.i.ConsumerRebalanceListenerInvoker : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Revoke previously assigned partitions wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2
2025-10-14T22:24:10.326+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: partitions revoked: [wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2]
2025-10-14T22:24:10.334+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Member consumer-wallet_events-1-36ee6cd4-1079-4c7f-9556-586597958394 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-10-14T22:24:10.342+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-10-14T22:24:10.342+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: consumer pro-actively leaving the group
2025-10-14T22:24:10.343+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer         : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Unsubscribed all topics or patterns and assigned partitions
2025-10-14T22:24:10.367+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-10-14T22:24:10.368+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: consumer pro-actively leaving the group
2025-10-14T22:24:10.691+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T22:24:10.691+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T22:24:10.691+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-10-14T22:24:10.692+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T22:24:10.711+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-wallet_events-1 unregistered
2025-10-14T22:24:10.713+01:00  INFO 1684 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: Consumer stopped
2025-10-14T22:24:10.726+01:00  INFO 1684 --- [History-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T22:24:10.755+01:00  INFO 1684 --- [History-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T22:24:10.785+01:00  INFO 1684 --- [History-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:24:10.821+01:00  INFO 1684 --- [History-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:24:10.830+01:00  INFO 1684 --- [History-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:24:15.343+01:00  INFO 14472 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Starting HistoryServiceApplication using Java 21.0.6 with PID 14472 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\History-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:24:15.348+01:00  INFO 14472 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:24:16.441+01:00  INFO 14472 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:24:16.516+01:00  INFO 14472 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 63 ms. Found 1 JPA repository interface.
2025-10-14T22:24:17.200+01:00  INFO 14472 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8081 (http)
2025-10-14T22:24:17.215+01:00  INFO 14472 --- [History-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:24:17.216+01:00  INFO 14472 --- [History-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:24:17.290+01:00  INFO 14472 --- [History-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:24:17.291+01:00  INFO 14472 --- [History-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1860 ms
2025-10-14T22:24:17.470+01:00  INFO 14472 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:24:17.655+01:00  INFO 14472 --- [History-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@6e807e2
2025-10-14T22:24:17.657+01:00  INFO 14472 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:24:17.716+01:00  INFO 14472 --- [History-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:24:17.785+01:00  INFO 14472 --- [History-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:24:17.830+01:00  INFO 14472 --- [History-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:24:18.200+01:00  INFO 14472 --- [History-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:24:18.306+01:00  INFO 14472 --- [History-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:24:19.277+01:00  INFO 14472 --- [History-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:24:19.280+01:00  INFO 14472 --- [History-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:24:19.828+01:00  INFO 14472 --- [History-Service] [main] o.s.v.b.OptionalValidatorFactoryBean     : Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-10-14T22:24:20.426+01:00  INFO 14472 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8081 (http) with context path '/'
2025-10-14T22:24:20.482+01:00  INFO 14472 --- [History-Service] [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-wallet_events-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = wallet_events
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.ErrorHandlingDeserializer

2025-10-14T22:24:20.545+01:00  INFO 14472 --- [History-Service] [main] o.a.k.c.t.i.KafkaMetricsCollector        : initializing Kafka metrics collector
2025-10-14T22:24:20.734+01:00  INFO 14472 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T22:24:20.735+01:00  INFO 14472 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T22:24:20.735+01:00  INFO 14472 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760477060731
2025-10-14T22:24:20.741+01:00  INFO 14472 --- [History-Service] [main] o.a.k.c.c.i.ClassicKafkaConsumer         : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Subscribed to topic(s): wallet_event_topic
2025-10-14T22:24:20.769+01:00  INFO 14472 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Started HistoryServiceApplication in 6.349 seconds (process running for 8.085)
2025-10-14T22:24:21.580+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Cluster ID: -BOr3paVQdKG6HAFHtQDWw
2025-10-14T22:24:21.581+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-10-14T22:24:21.586+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] (Re-)joining group
2025-10-14T22:24:21.650+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: need to re-join with the given member-id: consumer-wallet_events-1-57b05eb2-bbf3-4fb1-8e27-3207f0dab3d0
2025-10-14T22:24:21.651+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] (Re-)joining group
2025-10-14T22:24:24.693+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Successfully joined group with generation Generation{generationId=7, memberId='consumer-wallet_events-1-57b05eb2-bbf3-4fb1-8e27-3207f0dab3d0', protocol='range'}
2025-10-14T22:24:24.703+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Finished assignment for group at generation 7: {consumer-wallet_events-1-57b05eb2-bbf3-4fb1-8e27-3207f0dab3d0=Assignment(partitions=[wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2])}
2025-10-14T22:24:24.723+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Successfully synced group in generation Generation{generationId=7, memberId='consumer-wallet_events-1-57b05eb2-bbf3-4fb1-8e27-3207f0dab3d0', protocol='range'}
2025-10-14T22:24:24.723+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Notifying assignor about the new Assignment(partitions=[wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2])
2025-10-14T22:24:24.727+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] k.c.c.i.ConsumerRebalanceListenerInvoker : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Adding newly assigned partitions: wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2
2025-10-14T22:24:24.748+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Found no committed offset for partition wallet_event_topic-1
2025-10-14T22:24:24.748+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Found no committed offset for partition wallet_event_topic-2
2025-10-14T22:24:24.750+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils        : Setting offset for partition wallet_event_topic-0 to the committed offset FetchPosition{offset=1, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-10-14T22:24:24.775+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting offset for partition wallet_event_topic-1 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-10-14T22:24:24.776+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting offset for partition wallet_event_topic-2 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-10-14T22:24:24.776+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: partitions assigned: [wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2]
2025-10-14T22:28:30.860+01:00  INFO 9932 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-14T22:28:30.862+01:00  INFO 9932 --- [Wallet-Service] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-10-14T22:28:30.872+01:00  INFO 9932 --- [Wallet-Service] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 10 ms
2025-10-14T22:28:31.074+01:00  INFO 9932 --- [Wallet-Service] [http-nio-8080-exec-1] c.vic.walletservice.Kafka.KafkaProducer  : Sending event with body WalletEvent[eventType=WALLET_CREATED, walletId=02c05692-3565-4ec3-8d6e-a7ec050b780e, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:28:30.948551900]
2025-10-14T22:28:31.106+01:00  INFO 9932 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-producer-1
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-10-14T22:28:31.161+01:00  INFO 9932 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.k.c.t.i.KafkaMetricsCollector        : initializing Kafka metrics collector
2025-10-14T22:28:31.210+01:00  INFO 9932 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=Wallet-Service-producer-1] Instantiated an idempotent producer.
2025-10-14T22:28:31.256+01:00  INFO 9932 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.k.clients.producer.ProducerConfig    : These configurations '[max-in-flight-requests-per-connection, enable-idempotence, spring.json.trusted.packages, delivery-timeout-ms, spring.serializer.value.delegate.class]' were supplied but are not used yet.
2025-10-14T22:28:31.257+01:00  INFO 9932 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T22:28:31.257+01:00  INFO 9932 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T22:28:31.258+01:00  INFO 9932 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760477311257
2025-10-14T22:28:31.295+01:00  INFO 9932 --- [Wallet-Service] [kafka-producer-network-thread | Wallet-Service-producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=Wallet-Service-producer-1] Cluster ID: -BOr3paVQdKG6HAFHtQDWw
2025-10-14T22:28:31.365+01:00  INFO 9932 --- [Wallet-Service] [http-nio-8080-exec-1] c.v.w.Services.walletService             : Sent event asynchronously WalletEvent[eventType=WALLET_CREATED, walletId=02c05692-3565-4ec3-8d6e-a7ec050b780e, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:28:30.948551900]
2025-10-14T22:28:31.751+01:00  INFO 9932 --- [Wallet-Service] [kafka-producer-network-thread | Wallet-Service-producer-1] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=Wallet-Service-producer-1] ProducerId set to 2000 with epoch 0
2025-10-14T22:28:31.971+01:00 ERROR 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.kafka.listener.DefaultErrorHandler   : Backoff FixedBackOff{interval=0, currentAttempts=1, maxAttempts=0} exhausted for wallet_event_topic-2@0

org.springframework.kafka.listener.ListenerExecutionFailedException: Listener failed
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2998) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.checkDeser(KafkaMessageListenerContainer.java:3046) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2860) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2777) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2614) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2503) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2152) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1528) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1466) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1335) ~[spring-kafka-3.3.10.jar:3.3.10]
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run$$$capture(CompletableFuture.java:1804) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.kafka.support.serializer.DeserializationException: failed to deserialize
	at org.springframework.kafka.support.serializer.SerializationUtils.deserializationException(SerializationUtils.java:158) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.support.serializer.ErrorHandlingDeserializer.deserialize(ErrorHandlingDeserializer.java:218) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.apache.kafka.common.serialization.Deserializer.deserialize(Deserializer.java:81) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.CompletedFetch.parseRecord(CompletedFetch.java:327) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.CompletedFetch.fetchRecords(CompletedFetch.java:284) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.FetchCollector.fetchRecords(FetchCollector.java:169) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.FetchCollector.collectFetch(FetchCollector.java:135) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.Fetcher.collectFetch(Fetcher.java:146) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.ClassicKafkaConsumer.pollForFetches(ClassicKafkaConsumer.java:699) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.ClassicKafkaConsumer.poll(ClassicKafkaConsumer.java:623) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.ClassicKafkaConsumer.poll(ClassicKafkaConsumer.java:596) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:874) ~[kafka-clients-3.9.1.jar:na]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollConsumer(KafkaMessageListenerContainer.java:1692) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doPoll(KafkaMessageListenerContainer.java:1667) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1445) ~[spring-kafka-3.3.10.jar:3.3.10]
	... 4 common frames omitted
Caused by: java.lang.IllegalStateException: No type information in headers and no default type provided
	at org.springframework.util.Assert.state(Assert.java:79) ~[spring-core-6.2.11.jar:6.2.11]
	at org.springframework.kafka.support.serializer.JsonDeserializer.deserialize(JsonDeserializer.java:598) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.support.serializer.ErrorHandlingDeserializer.deserialize(ErrorHandlingDeserializer.java:215) ~[spring-kafka-3.3.10.jar:3.3.10]
	... 17 common frames omitted

2025-10-14T22:34:37.781+01:00  INFO 9932 --- [Wallet-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T22:34:37.799+01:00  INFO 9932 --- [Wallet-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T22:34:37.808+01:00  INFO 9932 --- [Wallet-Service] [SpringApplicationShutdownHook] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=Wallet-Service-producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-10-14T22:34:37.820+01:00  INFO 9932 --- [Wallet-Service] [SpringApplicationShutdownHook] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T22:34:37.820+01:00  INFO 9932 --- [Wallet-Service] [SpringApplicationShutdownHook] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T22:34:37.820+01:00  INFO 9932 --- [Wallet-Service] [SpringApplicationShutdownHook] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-10-14T22:34:37.820+01:00  INFO 9932 --- [Wallet-Service] [SpringApplicationShutdownHook] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T22:34:37.822+01:00  INFO 9932 --- [Wallet-Service] [SpringApplicationShutdownHook] o.a.kafka.common.utils.AppInfoParser     : App info kafka.producer for Wallet-Service-producer-1 unregistered
2025-10-14T22:34:37.833+01:00  INFO 9932 --- [Wallet-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:34:37.852+01:00  INFO 9932 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:34:37.859+01:00  INFO 9932 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:34:42.645+01:00  INFO 13148 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Starting WalletServiceApplication using Java 21.0.6 with PID 13148 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\Wallet-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:34:42.648+01:00  INFO 13148 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:34:43.604+01:00  INFO 13148 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:34:43.677+01:00  INFO 13148 --- [Wallet-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 60 ms. Found 2 JPA repository interfaces.
2025-10-14T22:34:44.304+01:00  INFO 13148 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T22:34:44.330+01:00  INFO 13148 --- [Wallet-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:34:44.330+01:00  INFO 13148 --- [Wallet-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:34:44.403+01:00  INFO 13148 --- [Wallet-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:34:44.404+01:00  INFO 13148 --- [Wallet-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1695 ms
2025-10-14T22:34:44.727+01:00  INFO 13148 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:34:44.918+01:00  INFO 13148 --- [Wallet-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@67941d
2025-10-14T22:34:44.919+01:00  INFO 13148 --- [Wallet-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:34:44.958+01:00  INFO 13148 --- [Wallet-Service] [main] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:5432/postgres (PostgreSQL 17.5)
2025-10-14T22:34:45.065+01:00  INFO 13148 --- [Wallet-Service] [main] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.054s)
2025-10-14T22:34:45.093+01:00  INFO 13148 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Current version of schema "public": 2
2025-10-14T22:34:45.100+01:00  INFO 13148 --- [Wallet-Service] [main] o.f.core.internal.command.DbMigrate      : Schema "public" is up to date. No migration necessary.
2025-10-14T22:34:45.210+01:00  INFO 13148 --- [Wallet-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:34:45.314+01:00  INFO 13148 --- [Wallet-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:34:45.367+01:00  INFO 13148 --- [Wallet-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:34:45.760+01:00  INFO 13148 --- [Wallet-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:34:45.877+01:00  INFO 13148 --- [Wallet-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:34:46.948+01:00  INFO 13148 --- [Wallet-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:34:46.952+01:00  INFO 13148 --- [Wallet-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:34:47.287+01:00  INFO 13148 --- [Wallet-Service] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-10-14T22:34:48.566+01:00  INFO 13148 --- [Wallet-Service] [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	auto.include.jmx.reporter = true
	bootstrap.controllers = []
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-admin-0
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	enable.metrics.push = true
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2025-10-14T22:34:48.679+01:00  INFO 13148 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T22:34:48.679+01:00  INFO 13148 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T22:34:48.679+01:00  INFO 13148 --- [Wallet-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760477688676
2025-10-14T22:34:49.336+01:00  INFO 13148 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for Wallet-Service-admin-0 unregistered
2025-10-14T22:34:49.343+01:00  INFO 13148 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T22:34:49.343+01:00  INFO 13148 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T22:34:49.343+01:00  INFO 13148 --- [Wallet-Service] [kafka-admin-client-thread | Wallet-Service-admin-0] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T22:34:49.360+01:00  INFO 13148 --- [Wallet-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2025-10-14T22:34:49.371+01:00  INFO 13148 --- [Wallet-Service] [main] c.v.w.WalletServiceApplication           : Started WalletServiceApplication in 7.584 seconds (process running for 9.096)
2025-10-14T22:35:05.746+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] k.c.c.i.ConsumerRebalanceListenerInvoker : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Revoke previously assigned partitions wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2
2025-10-14T22:35:05.752+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: partitions revoked: [wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2]
2025-10-14T22:35:05.756+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Member consumer-wallet_events-1-57b05eb2-bbf3-4fb1-8e27-3207f0dab3d0 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-10-14T22:35:05.760+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-10-14T22:35:05.760+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: consumer pro-actively leaving the group
2025-10-14T22:35:05.760+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer         : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Unsubscribed all topics or patterns and assigned partitions
2025-10-14T22:35:05.783+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-10-14T22:35:05.784+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: consumer pro-actively leaving the group
2025-10-14T22:35:06.003+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T22:35:06.004+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T22:35:06.004+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-10-14T22:35:06.004+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T22:35:06.032+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-wallet_events-1 unregistered
2025-10-14T22:35:06.033+01:00  INFO 14472 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: Consumer stopped
2025-10-14T22:35:06.056+01:00  INFO 14472 --- [History-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T22:35:06.089+01:00  INFO 14472 --- [History-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T22:35:06.123+01:00  INFO 14472 --- [History-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:35:06.172+01:00  INFO 14472 --- [History-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:35:06.194+01:00  INFO 14472 --- [History-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:35:09.902+01:00  INFO 7616 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Starting HistoryServiceApplication using Java 21.0.6 with PID 7616 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\History-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:35:09.906+01:00  INFO 7616 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:35:10.840+01:00  INFO 7616 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:35:10.898+01:00  INFO 7616 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 49 ms. Found 1 JPA repository interface.
2025-10-14T22:35:11.726+01:00  INFO 7616 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8081 (http)
2025-10-14T22:35:11.743+01:00  INFO 7616 --- [History-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:35:11.743+01:00  INFO 7616 --- [History-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:35:11.842+01:00  INFO 7616 --- [History-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:35:11.843+01:00  INFO 7616 --- [History-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1877 ms
2025-10-14T22:35:12.004+01:00  INFO 7616 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:35:12.169+01:00  INFO 7616 --- [History-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@1b1252c8
2025-10-14T22:35:12.172+01:00  INFO 7616 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:35:12.216+01:00  INFO 7616 --- [History-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:35:12.284+01:00  INFO 7616 --- [History-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:35:12.334+01:00  INFO 7616 --- [History-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:35:12.758+01:00  INFO 7616 --- [History-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:35:12.908+01:00  INFO 7616 --- [History-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:35:13.868+01:00  INFO 7616 --- [History-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:35:13.873+01:00  INFO 7616 --- [History-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:35:14.439+01:00  INFO 7616 --- [History-Service] [main] o.s.v.b.OptionalValidatorFactoryBean     : Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-10-14T22:35:15.081+01:00  INFO 7616 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8081 (http) with context path '/'
2025-10-14T22:35:15.123+01:00  INFO 7616 --- [History-Service] [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-wallet_events-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = wallet_events
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.ErrorHandlingDeserializer

2025-10-14T22:35:15.183+01:00  INFO 7616 --- [History-Service] [main] o.a.k.c.t.i.KafkaMetricsCollector        : initializing Kafka metrics collector
2025-10-14T22:35:15.290+01:00  INFO 7616 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T22:35:15.291+01:00  INFO 7616 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T22:35:15.291+01:00  INFO 7616 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760477715288
2025-10-14T22:35:15.305+01:00  INFO 7616 --- [History-Service] [main] o.a.k.c.c.i.ClassicKafkaConsumer         : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Subscribed to topic(s): wallet_event_topic
2025-10-14T22:35:15.346+01:00  INFO 7616 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Started HistoryServiceApplication in 6.241 seconds (process running for 7.611)
2025-10-14T22:35:15.841+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Cluster ID: -BOr3paVQdKG6HAFHtQDWw
2025-10-14T22:35:15.842+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-10-14T22:35:15.845+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] (Re-)joining group
2025-10-14T22:35:15.877+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: need to re-join with the given member-id: consumer-wallet_events-1-fd05c246-dcb6-4fcb-bcdd-c1d5fa03f5ae
2025-10-14T22:35:15.877+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] (Re-)joining group
2025-10-14T22:35:18.901+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Successfully joined group with generation Generation{generationId=9, memberId='consumer-wallet_events-1-fd05c246-dcb6-4fcb-bcdd-c1d5fa03f5ae', protocol='range'}
2025-10-14T22:35:18.910+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Finished assignment for group at generation 9: {consumer-wallet_events-1-fd05c246-dcb6-4fcb-bcdd-c1d5fa03f5ae=Assignment(partitions=[wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2])}
2025-10-14T22:35:18.925+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Successfully synced group in generation Generation{generationId=9, memberId='consumer-wallet_events-1-fd05c246-dcb6-4fcb-bcdd-c1d5fa03f5ae', protocol='range'}
2025-10-14T22:35:18.926+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Notifying assignor about the new Assignment(partitions=[wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2])
2025-10-14T22:35:18.929+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] k.c.c.i.ConsumerRebalanceListenerInvoker : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Adding newly assigned partitions: wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2
2025-10-14T22:35:18.943+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Found no committed offset for partition wallet_event_topic-1
2025-10-14T22:35:18.945+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils        : Setting offset for partition wallet_event_topic-2 to the committed offset FetchPosition{offset=1, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-10-14T22:35:18.945+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils        : Setting offset for partition wallet_event_topic-0 to the committed offset FetchPosition{offset=1, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-10-14T22:35:18.962+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting offset for partition wallet_event_topic-1 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-10-14T22:35:18.962+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: partitions assigned: [wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2]
2025-10-14T22:35:38.504+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-14T22:35:38.505+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-10-14T22:35:38.510+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2025-10-14T22:35:38.673+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-1] c.vic.walletservice.Kafka.KafkaProducer  : Sending event with body WalletEvent[eventType=WALLET_CREATED, walletId=861ba5bf-483f-4789-9138-25be9f49c5fc, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:35:38.564912600]
2025-10-14T22:35:38.699+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = Wallet-Service-producer-1
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 3
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-10-14T22:35:38.742+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.k.c.t.i.KafkaMetricsCollector        : initializing Kafka metrics collector
2025-10-14T22:35:38.766+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=Wallet-Service-producer-1] Instantiated an idempotent producer.
2025-10-14T22:35:38.792+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.k.clients.producer.ProducerConfig    : These configurations '[max-in-flight-requests-per-connection, enable-idempotence, spring.json.trusted.packages, delivery-timeout-ms, spring.serializer.value.delegate.class]' were supplied but are not used yet.
2025-10-14T22:35:38.792+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T22:35:38.792+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T22:35:38.793+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-1] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760477738792
2025-10-14T22:35:38.809+01:00  INFO 13148 --- [Wallet-Service] [kafka-producer-network-thread | Wallet-Service-producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=Wallet-Service-producer-1] Cluster ID: -BOr3paVQdKG6HAFHtQDWw
2025-10-14T22:35:38.813+01:00  INFO 13148 --- [Wallet-Service] [kafka-producer-network-thread | Wallet-Service-producer-1] o.a.k.c.p.internals.TransactionManager   : [Producer clientId=Wallet-Service-producer-1] ProducerId set to 2001 with epoch 0
2025-10-14T22:35:38.846+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-1] c.v.w.Services.walletService             : Sent event asynchronously WalletEvent[eventType=WALLET_CREATED, walletId=861ba5bf-483f-4789-9138-25be9f49c5fc, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:35:38.564912600]
2025-10-14T22:35:39.002+01:00 ERROR 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.kafka.listener.DefaultErrorHandler   : Backoff FixedBackOff{interval=0, currentAttempts=1, maxAttempts=0} exhausted for wallet_event_topic-0@1

org.springframework.kafka.listener.ListenerExecutionFailedException: Listener failed
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2998) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.checkDeser(KafkaMessageListenerContainer.java:3046) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2860) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2777) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2614) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2503) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2152) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1528) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1466) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1335) ~[spring-kafka-3.3.10.jar:3.3.10]
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run$$$capture(CompletableFuture.java:1804) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.springframework.kafka.support.serializer.DeserializationException: failed to deserialize
	at org.springframework.kafka.support.serializer.SerializationUtils.deserializationException(SerializationUtils.java:158) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.support.serializer.ErrorHandlingDeserializer.deserialize(ErrorHandlingDeserializer.java:218) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.apache.kafka.common.serialization.Deserializer.deserialize(Deserializer.java:81) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.CompletedFetch.parseRecord(CompletedFetch.java:327) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.CompletedFetch.fetchRecords(CompletedFetch.java:284) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.FetchCollector.fetchRecords(FetchCollector.java:169) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.FetchCollector.collectFetch(FetchCollector.java:135) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.Fetcher.collectFetch(Fetcher.java:146) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.ClassicKafkaConsumer.pollForFetches(ClassicKafkaConsumer.java:699) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.ClassicKafkaConsumer.poll(ClassicKafkaConsumer.java:623) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.internals.ClassicKafkaConsumer.poll(ClassicKafkaConsumer.java:596) ~[kafka-clients-3.9.1.jar:na]
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:874) ~[kafka-clients-3.9.1.jar:na]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollConsumer(KafkaMessageListenerContainer.java:1692) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doPoll(KafkaMessageListenerContainer.java:1667) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1445) ~[spring-kafka-3.3.10.jar:3.3.10]
	... 4 common frames omitted
Caused by: org.springframework.messaging.converter.MessageConversionException: failed to resolve class name. Class not found [WalletEvent]
	at org.springframework.kafka.support.mapping.DefaultJackson2JavaTypeMapper.getClassIdType(DefaultJackson2JavaTypeMapper.java:136) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.support.mapping.DefaultJackson2JavaTypeMapper.toJavaType(DefaultJackson2JavaTypeMapper.java:97) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.support.serializer.JsonDeserializer.deserialize(JsonDeserializer.java:587) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.support.serializer.ErrorHandlingDeserializer.deserialize(ErrorHandlingDeserializer.java:215) ~[spring-kafka-3.3.10.jar:3.3.10]
	... 17 common frames omitted
Caused by: java.lang.ClassNotFoundException: WalletEvent
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641) ~[na:na]
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188) ~[na:na]
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:526) ~[na:na]
	at java.base/java.lang.Class.forName0(Native Method) ~[na:na]
	at java.base/java.lang.Class.forName(Class.java:534) ~[na:na]
	at java.base/java.lang.Class.forName(Class.java:513) ~[na:na]
	at org.springframework.util.ClassUtils.forName(ClassUtils.java:321) ~[spring-core-6.2.11.jar:6.2.11]
	at org.springframework.kafka.support.mapping.DefaultJackson2JavaTypeMapper.getClassIdType(DefaultJackson2JavaTypeMapper.java:132) ~[spring-kafka-3.3.10.jar:3.3.10]
	... 20 common frames omitted

2025-10-14T22:40:30.321+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] k.c.c.i.ConsumerRebalanceListenerInvoker : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Revoke previously assigned partitions wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2
2025-10-14T22:40:30.322+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: partitions revoked: [wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2]
2025-10-14T22:40:30.323+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Member consumer-wallet_events-1-fd05c246-dcb6-4fcb-bcdd-c1d5fa03f5ae sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-10-14T22:40:30.323+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-10-14T22:40:30.323+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: consumer pro-actively leaving the group
2025-10-14T22:40:30.324+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer         : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Unsubscribed all topics or patterns and assigned partitions
2025-10-14T22:40:30.325+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-10-14T22:40:30.325+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: consumer pro-actively leaving the group
2025-10-14T22:40:30.655+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T22:40:30.656+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T22:40:30.656+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-10-14T22:40:30.656+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T22:40:30.662+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-wallet_events-1 unregistered
2025-10-14T22:40:30.663+01:00  INFO 7616 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: Consumer stopped
2025-10-14T22:40:30.665+01:00  INFO 7616 --- [History-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T22:40:30.671+01:00  INFO 7616 --- [History-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T22:40:30.678+01:00  INFO 7616 --- [History-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:40:30.681+01:00  INFO 7616 --- [History-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:40:30.685+01:00  INFO 7616 --- [History-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:40:34.871+01:00  INFO 17760 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Starting HistoryServiceApplication using Java 21.0.6 with PID 17760 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\History-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:40:34.876+01:00  INFO 17760 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:40:36.006+01:00  INFO 17760 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:40:36.079+01:00  INFO 17760 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 62 ms. Found 1 JPA repository interface.
2025-10-14T22:40:36.643+01:00  INFO 17760 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8081 (http)
2025-10-14T22:40:36.661+01:00  INFO 17760 --- [History-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:40:36.661+01:00  INFO 17760 --- [History-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:40:36.728+01:00  INFO 17760 --- [History-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:40:36.729+01:00  INFO 17760 --- [History-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1783 ms
2025-10-14T22:40:36.896+01:00  INFO 17760 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:40:37.073+01:00  INFO 17760 --- [History-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@7bede4ea
2025-10-14T22:40:37.075+01:00  INFO 17760 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:40:37.123+01:00  INFO 17760 --- [History-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:40:37.206+01:00  INFO 17760 --- [History-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:40:37.255+01:00  INFO 17760 --- [History-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:40:37.785+01:00  INFO 17760 --- [History-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:40:37.925+01:00  INFO 17760 --- [History-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:40:39.006+01:00  INFO 17760 --- [History-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:40:39.010+01:00  INFO 17760 --- [History-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:40:39.523+01:00  INFO 17760 --- [History-Service] [main] o.s.v.b.OptionalValidatorFactoryBean     : Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-10-14T22:40:40.125+01:00  INFO 17760 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8081 (http) with context path '/'
2025-10-14T22:40:40.200+01:00  INFO 17760 --- [History-Service] [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-wallet_events-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = wallet_events
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.ErrorHandlingDeserializer

2025-10-14T22:40:40.261+01:00  INFO 17760 --- [History-Service] [main] o.a.k.c.t.i.KafkaMetricsCollector        : initializing Kafka metrics collector
2025-10-14T22:40:40.401+01:00  INFO 17760 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T22:40:40.402+01:00  INFO 17760 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T22:40:40.402+01:00  INFO 17760 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760478040398
2025-10-14T22:40:40.408+01:00  INFO 17760 --- [History-Service] [main] o.a.k.c.c.i.ClassicKafkaConsumer         : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Subscribed to topic(s): wallet_event_topic
2025-10-14T22:40:40.429+01:00  INFO 17760 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Started HistoryServiceApplication in 6.537 seconds (process running for 7.684)
2025-10-14T22:40:41.009+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Cluster ID: -BOr3paVQdKG6HAFHtQDWw
2025-10-14T22:40:41.010+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-10-14T22:40:41.013+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] (Re-)joining group
2025-10-14T22:40:41.044+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: need to re-join with the given member-id: consumer-wallet_events-1-f3cfc418-2ca4-430c-94f5-26e520feac3a
2025-10-14T22:40:41.045+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] (Re-)joining group
2025-10-14T22:40:44.054+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Successfully joined group with generation Generation{generationId=11, memberId='consumer-wallet_events-1-f3cfc418-2ca4-430c-94f5-26e520feac3a', protocol='range'}
2025-10-14T22:40:44.063+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Finished assignment for group at generation 11: {consumer-wallet_events-1-f3cfc418-2ca4-430c-94f5-26e520feac3a=Assignment(partitions=[wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2])}
2025-10-14T22:40:44.073+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Successfully synced group in generation Generation{generationId=11, memberId='consumer-wallet_events-1-f3cfc418-2ca4-430c-94f5-26e520feac3a', protocol='range'}
2025-10-14T22:40:44.074+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Notifying assignor about the new Assignment(partitions=[wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2])
2025-10-14T22:40:44.077+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] k.c.c.i.ConsumerRebalanceListenerInvoker : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Adding newly assigned partitions: wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2
2025-10-14T22:40:44.084+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Found no committed offset for partition wallet_event_topic-1
2025-10-14T22:40:44.086+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils        : Setting offset for partition wallet_event_topic-2 to the committed offset FetchPosition{offset=1, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-10-14T22:40:44.086+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils        : Setting offset for partition wallet_event_topic-0 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-10-14T22:40:44.100+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting offset for partition wallet_event_topic-1 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-10-14T22:40:44.101+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: partitions assigned: [wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2]
2025-10-14T22:41:01.720+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-3] c.vic.walletservice.Kafka.KafkaProducer  : Sending event with body WalletEvent[eventType=WALLET_CREATED, walletId=16bdd339-6c0d-4539-bfac-ddf75590988d, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:41:01.709509300]
2025-10-14T22:41:01.743+01:00  INFO 13148 --- [Wallet-Service] [http-nio-8080-exec-3] c.v.w.Services.walletService             : Sent event asynchronously WalletEvent[eventType=WALLET_CREATED, walletId=16bdd339-6c0d-4539-bfac-ddf75590988d, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:41:01.709509300]
2025-10-14T22:41:02.022+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] c.v.historyservice.kafka.kafkaConsumer   : Consuming wallet event notification :: WalletEvent[eventType=WALLET_CREATED, walletId=16bdd339-6c0d-4539-bfac-ddf75590988d, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:41:01.709509300]
2025-10-14T22:41:02.272+01:00 ERROR 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] c.v.historyservice.kafka.kafkaConsumer   : Error while saving wallet event notification :: WalletEvent[eventType=WALLET_CREATED, walletId=16bdd339-6c0d-4539-bfac-ddf75590988d, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:41:01.709509300]

org.springframework.dao.DataIntegrityViolationException: not-null property references a null or transient value: com.vic.historyservice.Models.Transaction_events.createdAt
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:311) ~[spring-orm-6.2.11.jar:6.2.11]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.2.11.jar:6.2.11]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241) ~[spring-orm-6.2.11.jar:6.2.11]
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560) ~[spring-orm-6.2.11.jar:6.2.11]
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61) ~[spring-tx-6.2.11.jar:6.2.11]
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343) ~[spring-tx-6.2.11.jar:6.2.11]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160) ~[spring-tx-6.2.11.jar:6.2.11]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165) ~[spring-data-jpa-3.5.4.jar:3.5.4]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.11.jar:6.2.11]
	at jdk.proxy2/jdk.proxy2.$Proxy142.save(Unknown Source) ~[na:na]
	at com.vic.historyservice.kafka.kafkaConsumer.consumeWalletCreationEventNotification(kafkaConsumer.java:51) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-6.2.11.jar:6.2.11]
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-6.2.11.jar:6.2.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:78) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:475) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:421) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2887) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2865) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2777) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2614) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2503) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2152) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1528) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1466) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1335) ~[spring-kafka-3.3.10.jar:3.3.10]
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run$$$capture(CompletableFuture.java:1804) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.PropertyValueException: not-null property references a null or transient value: com.vic.historyservice.Models.Transaction_events.createdAt
	at org.hibernate.engine.internal.Nullability.checkNullability(Nullability.java:112) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.internal.Nullability.checkNullability(Nullability.java:57) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.action.internal.AbstractEntityInsertAction.nullifyTransientReferencesIfNotAlready(AbstractEntityInsertAction.java:126) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.action.internal.AbstractEntityInsertAction.makeEntityManaged(AbstractEntityInsertAction.java:135) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:301) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:261) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:407) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320) ~[spring-orm-6.2.11.jar:6.2.11]
	at jdk.proxy2/jdk.proxy2.$Proxy137.persist(Unknown Source) ~[na:na]
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654) ~[spring-data-jpa-3.5.4.jar:3.5.4]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277) ~[spring-data-commons-3.5.4.jar:3.5.4]
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.5.4.jar:3.5.4]
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.5.4.jar:3.5.4]
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515) ~[spring-data-commons-3.5.4.jar:3.5.4]
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284) ~[spring-data-commons-3.5.4.jar:3.5.4]
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734) ~[spring-data-commons-3.5.4.jar:3.5.4]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174) ~[spring-data-commons-3.5.4.jar:3.5.4]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.5.4.jar:3.5.4]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.5.4.jar:3.5.4]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380) ~[spring-tx-6.2.11.jar:6.2.11]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.2.11.jar:6.2.11]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.11.jar:6.2.11]
	... 28 common frames omitted

2025-10-14T22:42:26.397+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] k.c.c.i.ConsumerRebalanceListenerInvoker : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Revoke previously assigned partitions wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2
2025-10-14T22:42:26.398+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: partitions revoked: [wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2]
2025-10-14T22:42:26.398+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Member consumer-wallet_events-1-f3cfc418-2ca4-430c-94f5-26e520feac3a sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-10-14T22:42:26.398+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-10-14T22:42:26.399+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: consumer pro-actively leaving the group
2025-10-14T22:42:26.399+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer         : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Unsubscribed all topics or patterns and assigned partitions
2025-10-14T22:42:26.401+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-10-14T22:42:26.402+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: consumer pro-actively leaving the group
2025-10-14T22:42:26.436+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T22:42:26.436+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T22:42:26.436+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-10-14T22:42:26.436+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T22:42:26.444+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-wallet_events-1 unregistered
2025-10-14T22:42:26.445+01:00  INFO 17760 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: Consumer stopped
2025-10-14T22:42:26.447+01:00  INFO 17760 --- [History-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T22:42:26.454+01:00  INFO 17760 --- [History-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T22:42:26.459+01:00  INFO 17760 --- [History-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:42:26.460+01:00  INFO 17760 --- [History-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:42:26.469+01:00  INFO 17760 --- [History-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:42:31.358+01:00  INFO 13592 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Starting HistoryServiceApplication using Java 21.0.6 with PID 13592 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\History-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:42:31.360+01:00  INFO 13592 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:42:32.299+01:00  INFO 13592 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:42:32.358+01:00  INFO 13592 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 50 ms. Found 1 JPA repository interface.
2025-10-14T22:42:32.939+01:00  INFO 13592 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8081 (http)
2025-10-14T22:42:32.955+01:00  INFO 13592 --- [History-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:42:32.956+01:00  INFO 13592 --- [History-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:42:33.023+01:00  INFO 13592 --- [History-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:42:33.023+01:00  INFO 13592 --- [History-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1613 ms
2025-10-14T22:42:33.176+01:00  INFO 13592 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:42:33.343+01:00  INFO 13592 --- [History-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@1b1252c8
2025-10-14T22:42:33.345+01:00  INFO 13592 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:42:33.385+01:00  INFO 13592 --- [History-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:42:33.444+01:00  INFO 13592 --- [History-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:42:33.484+01:00  INFO 13592 --- [History-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:42:33.865+01:00  INFO 13592 --- [History-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:42:33.994+01:00  INFO 13592 --- [History-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:42:35.196+01:00  INFO 13592 --- [History-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:42:35.201+01:00  INFO 13592 --- [History-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:42:35.864+01:00  INFO 13592 --- [History-Service] [main] o.s.v.b.OptionalValidatorFactoryBean     : Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-10-14T22:42:36.523+01:00  INFO 13592 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8081 (http) with context path '/'
2025-10-14T22:42:36.580+01:00  INFO 13592 --- [History-Service] [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-wallet_events-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = wallet_events
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.ErrorHandlingDeserializer

2025-10-14T22:42:36.668+01:00  INFO 13592 --- [History-Service] [main] o.a.k.c.t.i.KafkaMetricsCollector        : initializing Kafka metrics collector
2025-10-14T22:42:36.826+01:00  INFO 13592 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T22:42:36.827+01:00  INFO 13592 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T22:42:36.828+01:00  INFO 13592 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760478156823
2025-10-14T22:42:36.835+01:00  INFO 13592 --- [History-Service] [main] o.a.k.c.c.i.ClassicKafkaConsumer         : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Subscribed to topic(s): wallet_event_topic
2025-10-14T22:42:36.860+01:00  INFO 13592 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Started HistoryServiceApplication in 6.186 seconds (process running for 7.459)
2025-10-14T22:42:37.432+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Cluster ID: -BOr3paVQdKG6HAFHtQDWw
2025-10-14T22:42:37.433+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-10-14T22:42:37.437+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] (Re-)joining group
2025-10-14T22:42:37.463+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: need to re-join with the given member-id: consumer-wallet_events-1-418e9920-7eae-4db9-9f66-15b737bb599a
2025-10-14T22:42:37.463+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] (Re-)joining group
2025-10-14T22:42:40.472+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Successfully joined group with generation Generation{generationId=13, memberId='consumer-wallet_events-1-418e9920-7eae-4db9-9f66-15b737bb599a', protocol='range'}
2025-10-14T22:42:40.483+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Finished assignment for group at generation 13: {consumer-wallet_events-1-418e9920-7eae-4db9-9f66-15b737bb599a=Assignment(partitions=[wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2])}
2025-10-14T22:42:40.491+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Successfully synced group in generation Generation{generationId=13, memberId='consumer-wallet_events-1-418e9920-7eae-4db9-9f66-15b737bb599a', protocol='range'}
2025-10-14T22:42:40.492+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Notifying assignor about the new Assignment(partitions=[wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2])
2025-10-14T22:42:40.494+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] k.c.c.i.ConsumerRebalanceListenerInvoker : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Adding newly assigned partitions: wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2
2025-10-14T22:42:40.501+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Found no committed offset for partition wallet_event_topic-1
2025-10-14T22:42:40.503+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils        : Setting offset for partition wallet_event_topic-2 to the committed offset FetchPosition{offset=1, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-10-14T22:42:40.504+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils        : Setting offset for partition wallet_event_topic-0 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-10-14T22:42:40.516+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting offset for partition wallet_event_topic-1 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-10-14T22:42:40.516+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: partitions assigned: [wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2]
2025-10-14T22:42:40.645+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] c.v.historyservice.kafka.kafkaConsumer   : Consuming wallet event notification :: WalletEvent[eventType=WALLET_CREATED, walletId=16bdd339-6c0d-4539-bfac-ddf75590988d, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:41:01.709509300]
2025-10-14T22:42:40.896+01:00  WARN 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-10-14T22:42:40.897+01:00 ERROR 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "event_data" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 124
2025-10-14T22:42:40.907+01:00 ERROR 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] c.v.historyservice.kafka.kafkaConsumer   : Error while saving wallet event notification :: WalletEvent[eventType=WALLET_CREATED, walletId=16bdd339-6c0d-4539-bfac-ddf75590988d, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:41:01.709509300]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "event_data" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 124] [insert into transaction_events (amount,created_at,event_data,event_type,transaction_id,user_id,wallet_id,id) values (?,?,?,?,?,?,?,?)]; SQL [insert into transaction_events (amount,created_at,event_data,event_type,transaction_id,user_id,wallet_id,id) values (?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281) ~[spring-orm-6.2.11.jar:6.2.11]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.2.11.jar:6.2.11]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241) ~[spring-orm-6.2.11.jar:6.2.11]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567) ~[spring-orm-6.2.11.jar:6.2.11]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.2.11.jar:6.2.11]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.2.11.jar:6.2.11]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698) ~[spring-tx-6.2.11.jar:6.2.11]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416) ~[spring-tx-6.2.11.jar:6.2.11]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.2.11.jar:6.2.11]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.11.jar:6.2.11]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165) ~[spring-data-jpa-3.5.4.jar:3.5.4]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.11.jar:6.2.11]
	at jdk.proxy2/jdk.proxy2.$Proxy142.save(Unknown Source) ~[na:na]
	at com.vic.historyservice.kafka.kafkaConsumer.consumeWalletCreationEventNotification(kafkaConsumer.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-6.2.11.jar:6.2.11]
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-6.2.11.jar:6.2.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:78) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:475) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:421) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2887) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2865) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2777) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2614) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2503) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2152) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1528) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1466) ~[spring-kafka-3.3.10.jar:3.3.10]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1335) ~[spring-kafka-3.3.10.jar:3.3.10]
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run$$$capture(CompletableFuture.java:1804) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "event_data" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 124] [insert into transaction_events (amount,created_at,event_data,event_type,transaction_id,user_id,wallet_id,id) values (?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:91) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563) ~[spring-orm-6.2.11.jar:6.2.11]
	... 35 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "event_data" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 124
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2734) ~[postgresql-42.7.7.jar:42.7.7]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2421) ~[postgresql-42.7.7.jar:42.7.7]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372) ~[postgresql-42.7.7.jar:42.7.7]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:518) ~[postgresql-42.7.7.jar:42.7.7]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:435) ~[postgresql-42.7.7.jar:42.7.7]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:196) ~[postgresql-42.7.7.jar:42.7.7]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:157) ~[postgresql-42.7.7.jar:42.7.7]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-6.3.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-6.3.3.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194) ~[hibernate-core-6.6.29.Final.jar:6.6.29.Final]
	... 56 common frames omitted

2025-10-14T22:57:07.387+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] k.c.c.i.ConsumerRebalanceListenerInvoker : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Revoke previously assigned partitions wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2
2025-10-14T22:57:07.469+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: partitions revoked: [wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2]
2025-10-14T22:57:07.477+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Member consumer-wallet_events-1-418e9920-7eae-4db9-9f66-15b737bb599a sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-10-14T22:57:07.488+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-10-14T22:57:07.488+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: consumer pro-actively leaving the group
2025-10-14T22:57:07.488+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer         : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Unsubscribed all topics or patterns and assigned partitions
2025-10-14T22:57:07.565+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-10-14T22:57:07.565+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: consumer pro-actively leaving the group
2025-10-14T22:57:07.894+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T22:57:07.894+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T22:57:07.895+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-10-14T22:57:07.896+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T22:57:07.959+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-wallet_events-1 unregistered
2025-10-14T22:57:07.967+01:00  INFO 13592 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: Consumer stopped
2025-10-14T22:57:08.015+01:00  INFO 13592 --- [History-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T22:57:08.082+01:00  INFO 13592 --- [History-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T22:57:08.155+01:00  INFO 13592 --- [History-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:57:08.223+01:00  INFO 13592 --- [History-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T22:57:08.267+01:00  INFO 13592 --- [History-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T22:57:19.409+01:00  INFO 20488 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Starting HistoryServiceApplication using Java 21.0.6 with PID 20488 (C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System\History-Service\target\classes started by vickt in C:\Users\vickt\Desktop\Digital_Wallet_Transaction_System)
2025-10-14T22:57:19.413+01:00  INFO 20488 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : No active profile set, falling back to 1 default profile: "default"
2025-10-14T22:57:20.685+01:00  INFO 20488 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-10-14T22:57:20.781+01:00  INFO 20488 --- [History-Service] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 79 ms. Found 1 JPA repository interface.
2025-10-14T22:57:21.551+01:00  INFO 20488 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8081 (http)
2025-10-14T22:57:21.572+01:00  INFO 20488 --- [History-Service] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T22:57:21.572+01:00  INFO 20488 --- [History-Service] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-14T22:57:21.673+01:00  INFO 20488 --- [History-Service] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-10-14T22:57:21.674+01:00  INFO 20488 --- [History-Service] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2174 ms
2025-10-14T22:57:21.898+01:00  INFO 20488 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-10-14T22:57:22.179+01:00  INFO 20488 --- [History-Service] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@1af677f8
2025-10-14T22:57:22.182+01:00  INFO 20488 --- [History-Service] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-10-14T22:57:22.238+01:00  INFO 20488 --- [History-Service] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-10-14T22:57:22.345+01:00  INFO 20488 --- [History-Service] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-10-14T22:57:22.413+01:00  INFO 20488 --- [History-Service] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-10-14T22:57:22.915+01:00  INFO 20488 --- [History-Service] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-10-14T22:57:23.388+01:00  INFO 20488 --- [History-Service] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-10-14T22:57:24.639+01:00  INFO 20488 --- [History-Service] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-10-14T22:57:24.644+01:00  INFO 20488 --- [History-Service] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T22:57:25.268+01:00  INFO 20488 --- [History-Service] [main] o.s.v.b.OptionalValidatorFactoryBean     : Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-10-14T22:57:26.105+01:00  INFO 20488 --- [History-Service] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8081 (http) with context path '/'
2025-10-14T22:57:26.175+01:00  INFO 20488 --- [History-Service] [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-wallet_events-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = wallet_events
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.ErrorHandlingDeserializer

2025-10-14T22:57:26.263+01:00  INFO 20488 --- [History-Service] [main] o.a.k.c.t.i.KafkaMetricsCollector        : initializing Kafka metrics collector
2025-10-14T22:57:26.445+01:00  INFO 20488 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.9.1
2025-10-14T22:57:26.445+01:00  INFO 20488 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: f745dfdcee2b9851
2025-10-14T22:57:26.445+01:00  INFO 20488 --- [History-Service] [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1760479046442
2025-10-14T22:57:26.450+01:00  INFO 20488 --- [History-Service] [main] o.a.k.c.c.i.ClassicKafkaConsumer         : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Subscribed to topic(s): wallet_event_topic
2025-10-14T22:57:26.476+01:00  INFO 20488 --- [History-Service] [main] c.v.h.HistoryServiceApplication          : Started HistoryServiceApplication in 8.818 seconds (process running for 11.189)
2025-10-14T22:57:27.211+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Cluster ID: -BOr3paVQdKG6HAFHtQDWw
2025-10-14T22:57:27.212+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-10-14T22:57:27.218+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] (Re-)joining group
2025-10-14T22:57:27.263+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: need to re-join with the given member-id: consumer-wallet_events-1-da18d2a0-0e62-4ce6-ba04-4f1bd84740ec
2025-10-14T22:57:27.264+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] (Re-)joining group
2025-10-14T22:57:30.284+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Successfully joined group with generation Generation{generationId=15, memberId='consumer-wallet_events-1-da18d2a0-0e62-4ce6-ba04-4f1bd84740ec', protocol='range'}
2025-10-14T22:57:30.294+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Finished assignment for group at generation 15: {consumer-wallet_events-1-da18d2a0-0e62-4ce6-ba04-4f1bd84740ec=Assignment(partitions=[wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2])}
2025-10-14T22:57:30.307+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Successfully synced group in generation Generation{generationId=15, memberId='consumer-wallet_events-1-da18d2a0-0e62-4ce6-ba04-4f1bd84740ec', protocol='range'}
2025-10-14T22:57:30.308+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Notifying assignor about the new Assignment(partitions=[wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2])
2025-10-14T22:57:30.311+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] k.c.c.i.ConsumerRebalanceListenerInvoker : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Adding newly assigned partitions: wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2
2025-10-14T22:57:30.326+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Found no committed offset for partition wallet_event_topic-1
2025-10-14T22:57:30.329+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils        : Setting offset for partition wallet_event_topic-2 to the committed offset FetchPosition{offset=1, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-10-14T22:57:30.329+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils        : Setting offset for partition wallet_event_topic-0 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-10-14T22:57:30.348+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting offset for partition wallet_event_topic-1 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-10-14T22:57:30.349+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: partitions assigned: [wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2]
2025-10-14T22:57:30.496+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] c.v.historyservice.kafka.kafkaConsumer   : Consuming wallet event notification :: WalletEvent[eventType=WALLET_CREATED, walletId=16bdd339-6c0d-4539-bfac-ddf75590988d, userId=userId234, amount=0, senderId=, receiverId=, transactionId=, timeStamp=2025-10-14T22:41:01.709509300]
2025-10-14T23:10:10.012+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] k.c.c.i.ConsumerRebalanceListenerInvoker : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Revoke previously assigned partitions wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2
2025-10-14T23:10:10.027+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: partitions revoked: [wallet_event_topic-0, wallet_event_topic-1, wallet_event_topic-2]
2025-10-14T23:10:10.030+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Member consumer-wallet_events-1-da18d2a0-0e62-4ce6-ba04-4f1bd84740ec sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-10-14T23:10:10.034+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-10-14T23:10:10.035+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: consumer pro-actively leaving the group
2025-10-14T23:10:10.035+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer         : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Unsubscribed all topics or patterns and assigned partitions
2025-10-14T23:10:10.052+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-10-14T23:10:10.052+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet_events-1, groupId=wallet_events] Request joining group due to: consumer pro-actively leaving the group
2025-10-14T23:10:10.347+01:00  INFO 13148 --- [Wallet-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T23:10:10.434+01:00  INFO 13148 --- [Wallet-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T23:10:10.465+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T23:10:10.466+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T23:10:10.466+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-10-14T23:10:10.466+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T23:10:10.491+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-wallet_events-1 unregistered
2025-10-14T23:10:10.494+01:00  INFO 20488 --- [History-Service] [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : wallet_events: Consumer stopped
2025-10-14T23:10:10.494+01:00  INFO 13148 --- [Wallet-Service] [SpringApplicationShutdownHook] o.a.k.clients.producer.KafkaProducer     : [Producer clientId=Wallet-Service-producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-10-14T23:10:10.503+01:00  INFO 20488 --- [History-Service] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-10-14T23:10:10.532+01:00  INFO 20488 --- [History-Service] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-10-14T23:10:10.555+01:00  INFO 20488 --- [History-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T23:10:10.568+01:00  INFO 20488 --- [History-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T23:10:10.594+01:00  INFO 20488 --- [History-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-10-14T23:10:10.618+01:00  INFO 13148 --- [Wallet-Service] [SpringApplicationShutdownHook] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2025-10-14T23:10:10.619+01:00  INFO 13148 --- [Wallet-Service] [SpringApplicationShutdownHook] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-10-14T23:10:10.621+01:00  INFO 13148 --- [Wallet-Service] [SpringApplicationShutdownHook] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-10-14T23:10:10.623+01:00  INFO 13148 --- [Wallet-Service] [SpringApplicationShutdownHook] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2025-10-14T23:10:11.075+01:00  INFO 13148 --- [Wallet-Service] [SpringApplicationShutdownHook] o.a.kafka.common.utils.AppInfoParser     : App info kafka.producer for Wallet-Service-producer-1 unregistered
2025-10-14T23:10:11.378+01:00  INFO 13148 --- [Wallet-Service] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-10-14T23:10:11.538+01:00  INFO 13148 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-10-14T23:10:11.639+01:00  INFO 13148 --- [Wallet-Service] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
